<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#4fcde3"><meta name="author" content="è½èŠ±ç”Ÿ"><meta name="copyright" content="è½èŠ±ç”Ÿ"><meta name="generator" content="Hexo 6.0.0"><meta name="theme" content="hexo-theme-yun"><title>Spring Boot å­¦ä¹ ç¬”è®° | å”¯è½èŠ±ç”Ÿ</title><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@900&amp;display=swap" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/star-markdown-css@0.1.25/dist/yun/yun-markdown.min.css"><script src="//at.alicdn.com/t/font_1140697_dxory92pb0h.js" async></script><script src="https://cdn.jsdelivr.net/npm/scrollreveal/dist/scrollreveal.min.js" defer></script><script>function initScrollReveal() {
  [".post-card",".post-content img"].forEach((target)=> {
    ScrollReveal().reveal(target);
  })
}
document.addEventListener("DOMContentLoaded", initScrollReveal);
document.addEventListener("pjax:success", initScrollReveal);
</script><link id="light-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism.css" media="(prefers-color-scheme: light)"><link id="dark-prism-css" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@latest/themes/prism-okaidia.css" media="(prefers-color-scheme: dark)"><link rel="icon" type="image/png" href="/favicon.png"><link rel="mask-icon" href="/favicon.png" color="#4fcde3"><link rel="preload" href="/css/hexo-theme-yun.css" as="style"><link rel="preload" href="/js/utils.js" as="script"><link rel="preload" href="/js/hexo-theme-yun.js" as="script"><link rel="prefetch" href="/js/sidebar.js" as="script"><link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin><script id="yun-config">
    const Yun = window.Yun || {};
    window.CONFIG = {"hostname":"dbin.top","root":"/","title":["è½","èŠ±","ç”Ÿ","çš„","å°","ç«™"],"version":"1.7.0","mode":"auto","copycode":true,"page":{"isPost":true},"i18n":{"placeholder":"æœç´¢...","empty":"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹: ${query}","hits":"æ‰¾åˆ° ${hits} æ¡ç»“æœ","hits_time":"æ‰¾åˆ° ${hits} æ¡ç»“æœï¼ˆç”¨æ—¶ ${time} æ¯«ç§’ï¼‰"},"anonymous_image":"https://cdn.jsdelivr.net/gh/YunYouJun/cdn/img/avatar/none.jpg","say":{"api":"https://v1.hitokoto.cn","hitokoto":true},"local_search":{"path":"/search.json"},"fireworks":{"colors":["0, 0, 0","255, 255, 255","128, 128, 128","201, 4, 17"]}};
  </script><link rel="stylesheet" href="/css/hexo-theme-yun.css"><script src="/js/utils.js"></script><script src="/js/hexo-theme-yun.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"><script src="//at.alicdn.com/t/font_2648851_os7f9jxepo.js" async></script><script src="/girlss/autoload.js" async></script><meta name="description" content="ç¬¬ä¸€ä¸ªSpring Booté¡¹ç›®é…ç½®ä¾èµ–pom.xml&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt; &lt;project xmlns&#x3D;&quot;http:&#x2F;&#x2F;maven.apache.org&#x2F;POM&#x2F;4.0.0&quot; xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;          xsi:schemaLoca">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring Boot å­¦ä¹ ç¬”è®°">
<meta property="og:url" content="https://dbin.top/2022/03/02/%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF/Spring%20Boot%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="å”¯è½èŠ±ç”Ÿ">
<meta property="og:description" content="ç¬¬ä¸€ä¸ªSpring Booté¡¹ç›®é…ç½®ä¾èµ–pom.xml&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;UTF-8&quot;?&gt; &lt;project xmlns&#x3D;&quot;http:&#x2F;&#x2F;maven.apache.org&#x2F;POM&#x2F;4.0.0&quot; xmlns:xsi&#x3D;&quot;http:&#x2F;&#x2F;www.w3.org&#x2F;2001&#x2F;XMLSchema-instance&quot;          xsi:schemaLoca">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://dbins.gitee.io/image/others/1.png">
<meta property="article:published_time" content="2022-03-01T16:27:57.000Z">
<meta property="article:modified_time" content="2022-05-03T09:32:42.358Z">
<meta property="article:author" content="è½èŠ±ç”Ÿ">
<meta property="article:tag" content="Java">
<meta property="article:tag" content="å¼€å‘">
<meta property="article:tag" content="Servlet">
<meta property="article:tag" content="åç«¯">
<meta property="article:tag" content="Spring Boot">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://dbins.gitee.io/image/others/1.png"><script src="/js/ui/mode.js"></script></head><body><script defer src="https://cdn.jsdelivr.net/npm/animejs@latest"></script><script defer src="/js/ui/fireworks.js"></script><canvas class="fireworks"></canvas><div class="container"><a class="sidebar-toggle hty-icon-button" id="menu-btn"><div class="hamburger hamburger--spin" type="button"><span class="hamburger-box"><span class="hamburger-inner"></span></span></div></a><div class="sidebar-toggle sidebar-overlay"></div><aside class="sidebar"><script src="/js/sidebar.js"></script><ul class="sidebar-nav"><li class="sidebar-nav-item sidebar-nav-toc hty-icon-button sidebar-nav-active" data-target="post-toc-wrap" title="æ–‡ç« ç›®å½•"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-list-ordered"></use></svg></li><li class="sidebar-nav-item sidebar-nav-overview hty-icon-button" data-target="site-overview-wrap" title="ç«™ç‚¹æ¦‚è§ˆ"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-passport-line"></use></svg></li></ul><div class="sidebar-panel" id="site-overview-wrap"><div class="site-info mickey-mouse"><a class="site-author-avatar" href="/about/" title="è½èŠ±ç”Ÿ"><img width="96" loading="lazy" src="http://dbins.gitee.io/image/head/head.jpg" alt="è½èŠ±ç”Ÿ"><span class="site-author-status" title="å¼€å¿ƒæ¯ä¸€å¤©">ğŸ¥°</span></a><div class="site-author-name"><a href="/about/">è½èŠ±ç”Ÿ</a></div><a class="site-name" href="/about/site.html">å”¯è½èŠ±ç”Ÿ</a><sub class="site-subtitle">improve oneself</sub><div class="site-desciption">èŠ±ç”Ÿæœ‰ä¸ªé•¿åœ¨æå¤´çš„ç†æƒ³å—ï¼Ÿ</div></div><nav class="site-state"><a class="site-state-item hty-icon-button icon-home" href="/" title="é¦–é¡µ"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-home"></use></svg></span></a><div class="site-state-item"><a href="/archives/" title="å½’æ¡£"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-guidang"></use></svg></span><span class="site-state-item-count">46</span></a></div><div class="site-state-item"><a href="/categories/" title="åˆ†ç±»"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-fenlei"></use></svg></span><span class="site-state-item-count">12</span></a></div><div class="site-state-item"><a href="/tags/" title="æ ‡ç­¾"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-biaoqian"></use></svg></span><span class="site-state-item-count">29</span></a></div><a class="site-state-item hty-icon-button" href="/others/index.html" title="others"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-shezhi1"></use></svg></span></a></nav><hr style="margin-bottom:0.5rem"><div class="links-of-author"><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:wanmujun@aliyun.com" title="E-Mail" target="_blank" style="color:undefined"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-icon-test"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="mailto:beifen404@gmail.com" title="å¤‡ç”¨é‚®ç®±" target="_blank" style="color:undefined"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-youxiang4"></use></svg></a><a class="links-of-author-item hty-icon-button" rel="noopener" href="https://www.baidu.com/s?ie=utf-8&amp;f=8&amp;rsv_bp=1&amp;rsv_idx=1&amp;tn=baidu&amp;wd=%E6%A1%83%E5%AD%90" title="Twitter" target="_blank" style="color:undefined"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-twitter-line"></use></svg></a></div><hr style="margin:0.5rem 1rem"><div class="links"><a class="links-item hty-icon-button" href="/links/" title="frends" style="color:dodgerblue"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-men-line"></use></svg></a><a class="links-item hty-icon-button" href="/girls/" title="MyGirl" style="color:#FF0000"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-women-line"></use></svg></a></div><br><a class="links-item hty-icon-button" id="toggle-mode-btn" href="javascript:;" title="Mode" style="color: #f1cb64"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-contrast-2-line"></use></svg></a></div><div class="sidebar-panel sidebar-panel-active" id="post-toc-wrap"><div class="post-toc"><div class="post-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AASpring-Boot%E9%A1%B9%E7%9B%AE"><span class="toc-number">1.</span> <span class="toc-text">ç¬¬ä¸€ä¸ªSpring Booté¡¹ç›®</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E4%BE%9D%E8%B5%96pom-xml"><span class="toc-number">1.1.</span> <span class="toc-text">é…ç½®ä¾èµ–pom.xml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%BB%E7%A8%8B%E5%BA%8F%E5%90%AF%E5%8A%A8%E7%B1%BB"><span class="toc-number">1.2.</span> <span class="toc-text">åˆ›å»ºä¸»ç¨‹åºå¯åŠ¨ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%A4%84%E7%90%86%E7%B1%BB"><span class="toc-number">1.3.</span> <span class="toc-text">åˆ›å»ºå¤„ç†ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IDEA%E7%83%AD%E9%83%A8%E7%BD%B2"><span class="toc-number">1.4.</span> <span class="toc-text">IDEAçƒ­éƒ¨ç½²</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E7%B1%BB%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="toc-number">1.5.</span> <span class="toc-text">æµ‹è¯•ç±»çš„ä½¿ç”¨</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-Boot-%E6%A0%B8%E5%BF%83%E9%85%8D%E7%BD%AE%E4%B8%8E%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text">Spring Boot æ ¸å¿ƒé…ç½®ä¸æ³¨è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6application-properties-%E4%B8%8E-application-yaml"><span class="toc-number">2.1.</span> <span class="toc-text">å…¨å±€é…ç½®æ–‡ä»¶application.properties ä¸ application.yaml</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#application-proprities"><span class="toc-number">2.1.1.</span> <span class="toc-text">application.proprities</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#application-yaml"><span class="toc-number">2.1.2.</span> <span class="toc-text">application.yaml</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E5%80%BC%E7%9A%84%E6%B3%A8%E5%85%A5"><span class="toc-number">2.2.</span> <span class="toc-text">é…ç½®æ–‡ä»¶å±æ€§å€¼çš„æ³¨å…¥</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Value%E6%B3%A8%E5%85%A5%E5%B1%9E%E6%80%A7"><span class="toc-number">2.2.1.</span> <span class="toc-text">ä½¿ç”¨@Valueæ³¨å…¥å±æ€§</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E6%B3%A8%E8%A7%A3%E5%AF%B9%E6%AF%94"><span class="toc-number">2.2.2.</span> <span class="toc-text">ä¸¤ç§æ³¨è§£å¯¹æ¯”</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE"><span class="toc-number">2.3.</span> <span class="toc-text">è‡ªå®šä¹‰é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-PropertySource%E5%8A%A0%E8%BD%BD%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.1.</span> <span class="toc-text">ä½¿ç”¨@PropertySourceåŠ è½½é…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-ImportResource%E5%8A%A0%E8%BD%BDXML%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">2.3.2.</span> <span class="toc-text">ä½¿ç”¨@ImportResourceåŠ è½½XMLé…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Configuration%E7%BC%96%E5%86%99%E8%87%AA%E5%AE%9A%E4%B9%89%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-number">2.3.3.</span> <span class="toc-text">ä½¿ç”¨@Configurationç¼–å†™è‡ªå®šä¹‰é…ç½®ç±»</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Profile%E5%A4%9A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">2.4.</span> <span class="toc-text">Profileå¤šç¯å¢ƒé…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Profile%E6%96%87%E4%BB%B6"><span class="toc-number">2.4.1.</span> <span class="toc-text">ä½¿ç”¨Profileæ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Profile%E6%B3%A8%E8%A7%A3"><span class="toc-number">2.4.2.</span> <span class="toc-text">ä½¿ç”¨@Profileæ³¨è§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E5%80%BC%E8%AE%BE%E7%BD%AE%E4%BB%A5%E5%8F%8A%E5%8F%82%E6%95%B0%E5%BC%95%E7%94%A8"><span class="toc-number">2.4.3.</span> <span class="toc-text">éšæœºå€¼è®¾ç½®ä»¥åŠå‚æ•°å¼•ç”¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Mybatis"><span class="toc-number">2.5.</span> <span class="toc-text">Mybatis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96"><span class="toc-number">2.5.1.</span> <span class="toc-text">æ·»åŠ ä¾èµ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">2.5.2.</span> <span class="toc-text">é…ç½®å‚æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-number">2.5.3.</span> <span class="toc-text">åˆ›å»ºé…ç½®ç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%AD%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%AF%B9%E5%BA%94%E7%9A%84%E7%B1%BB"><span class="toc-number">2.5.4.</span> <span class="toc-text">åˆ›å»ºå’Œæ•°æ®åº“ä¸­æ•°æ®ç±»å‹å¯¹åº”çš„ç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B3%A8%E8%A7%A3%E6%95%B4%E5%90%88MyBatis"><span class="toc-number">2.5.5.</span> <span class="toc-text">ä½¿ç”¨æ³¨è§£æ•´åˆMyBatis</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAMapper%E6%8E%A5%E5%8F%A3%E6%96%87%E4%BB%B6"><span class="toc-number">2.5.5.1.</span> <span class="toc-text">åˆ›å»ºMapperæ¥å£æ–‡ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%B5%8B%E8%AF%95%E7%B1%BB%E6%B5%8B%E8%AF%95"><span class="toc-number">2.5.5.2.</span> <span class="toc-text">ä½¿ç”¨æµ‹è¯•ç±»æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E6%95%B4%E5%90%88MyBatis"><span class="toc-number">2.5.6.</span> <span class="toc-text">ä½¿ç”¨é…ç½®æ–‡ä»¶æ•´åˆMyBatis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAArticleMapper%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.5.7.</span> <span class="toc-text">åˆ›å»ºArticleMapperæ¥å£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6"><span class="toc-number">2.5.8.</span> <span class="toc-text">åˆ›å»ºæ˜ å°„æ–‡ä»¶</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%85%A8%E5%B1%80%E6%96%87%E4%BB%B6%EF%BC%8C%E9%85%8D%E7%BD%AEXML%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84"><span class="toc-number">2.5.9.</span> <span class="toc-text">é…ç½®å…¨å±€æ–‡ä»¶ï¼Œé…ç½®XMLæ˜ å°„æ–‡ä»¶è·¯å¾„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95"><span class="toc-number">2.5.10.</span> <span class="toc-text">æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E5%90%88JPA"><span class="toc-number">2.6.</span> <span class="toc-text">æ•´åˆJPA</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E4%BE%9D%E8%B5%96-1"><span class="toc-number">2.6.1.</span> <span class="toc-text">æ·»åŠ ä¾èµ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0-1"><span class="toc-number">2.6.2.</span> <span class="toc-text">é…ç½®å‚æ•°</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%85%8D%E7%BD%AE%E7%B1%BB-1"><span class="toc-number">2.6.3.</span> <span class="toc-text">åˆ›å»ºé…ç½®ç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-number">2.6.4.</span> <span class="toc-text">ç¼–å†™å®ä½“ç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%96%E5%86%99Repository%E6%8E%A5%E5%8F%A3"><span class="toc-number">2.6.5.</span> <span class="toc-text">ç¼–å†™Repositoryæ¥å£</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E5%90%88Redis"><span class="toc-number">2.7.</span> <span class="toc-text">æ•´åˆRedis</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD%E5%AE%89%E8%A3%85%E5%BC%80%E5%90%AFRedis"><span class="toc-number">2.7.1.</span> <span class="toc-text">ä¸‹è½½å®‰è£…å¼€å¯Redis</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0redis%E4%BE%9D%E8%B5%96"><span class="toc-number">2.7.2.</span> <span class="toc-text">æ·»åŠ redisä¾èµ–</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE"><span class="toc-number">2.7.3.</span> <span class="toc-text">æ–‡ä»¶é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-number">2.7.4.</span> <span class="toc-text">åˆ›å»ºå®ä½“ç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95-1"><span class="toc-number">2.7.5.</span> <span class="toc-text">æµ‹è¯•</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-boot-%E8%A7%86%E5%9B%BE%E6%8A%80%E6%9C%AF"><span class="toc-number">3.</span> <span class="toc-text">Spring boot è§†å›¾æŠ€æœ¯</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Thymeleaf%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95"><span class="toc-number">3.1.</span> <span class="toc-text">ThymeleafåŸºæœ¬è¯­æ³•</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%87%E5%87%86%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.1.1.</span> <span class="toc-text">æ ‡å‡†è¡¨è¾¾å¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%8F%98%E9%87%8F%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.1.2.</span> <span class="toc-text">é€‰æ‹©å˜é‡è¡¨è¾¾å¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.1.3.</span> <span class="toc-text">è¿æ¥è¡¨è¾¾å¼</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%87%E6%AE%B5%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.1.4.</span> <span class="toc-text">ç‰‡æ®µè¡¨è¾¾å¼</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Thymeleaf%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">3.2.</span> <span class="toc-text">ThymeleafåŸºæœ¬ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9D%99%E6%80%81%E9%A1%B5%E9%9D%A2%E7%9A%84%E8%AE%BF%E9%97%AE"><span class="toc-number">3.2.1.</span> <span class="toc-text">é™æ€é¡µé¢çš„è®¿é—®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Thymeleaf"><span class="toc-number">3.2.2.</span> <span class="toc-text">ä½¿ç”¨Thymeleaf</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Thymeleaf%E9%85%8D%E7%BD%AE%E5%9B%BD%E9%99%85%E5%8C%96%E9%A1%B5%E9%9D%A2"><span class="toc-number">3.2.3.</span> <span class="toc-text">ä½¿ç”¨Thymeleafé…ç½®å›½é™…åŒ–é¡µé¢</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-Boot-%E5%AE%9E%E7%8E%B0Web%E7%9A%84%E5%B8%B8%E7%94%A8%E5%8A%9F%E8%83%BD"><span class="toc-number">4.</span> <span class="toc-text">Spring Boot å®ç°Webçš„å¸¸ç”¨åŠŸèƒ½</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-MVC%E5%8A%9F%E8%83%BD%E6%89%A9%E5%B1%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">4.1.</span> <span class="toc-text">Spring MVCåŠŸèƒ½æ‰©å±•å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E6%98%A0%E5%B0%84"><span class="toc-number">4.1.1.</span> <span class="toc-text">è·¯å¾„æ˜ å°„</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89%E4%B8%80%E4%B8%AA%E6%8B%A6%E6%88%AA%E5%99%A8"><span class="toc-number">4.1.2.</span> <span class="toc-text">è‡ªå®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Spring-Boot-%E6%95%B4%E5%90%88Servlet%E4%B8%89%E5%A4%A7%E7%BB%84%E4%BB%B6"><span class="toc-number">4.2.</span> <span class="toc-text">Spring Boot æ•´åˆServletä¸‰å¤§ç»„ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E6%B3%A8%E5%86%8C%E6%95%B4%E5%90%88Servlet%E4%B8%89%E7%BB%84%E4%BB%B6"><span class="toc-number">4.2.1.</span> <span class="toc-text">ç»„ä»¶æ³¨å†Œæ•´åˆServletä¸‰ç»„ä»¶</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%95%B4%E5%90%88Servlet"><span class="toc-number">4.2.1.1.</span> <span class="toc-text">æ•´åˆServlet</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%84%E5%90%88Filter"><span class="toc-number">4.2.1.2.</span> <span class="toc-text">ç»„åˆFilter</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%84%E5%90%88Listener"><span class="toc-number">4.2.1.3.</span> <span class="toc-text">ç»„åˆListener</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E8%B7%AF%E5%BE%84%E6%89%AB%E6%8F%8F%E6%95%B4%E5%90%88Servlet%E7%BB%84%E4%BB%B6"><span class="toc-number">4.2.2.</span> <span class="toc-text">ä½¿ç”¨è·¯å¾„æ‰«ææ•´åˆServletç»„ä»¶</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%9A%84%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD"><span class="toc-number">4.3.</span> <span class="toc-text">æ–‡ä»¶çš„ä¸Šä¼ ä¸‹è½½</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">4.3.1.</span> <span class="toc-text">æ–‡ä»¶ä¸Šä¼ </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD"><span class="toc-number">4.3.2.</span> <span class="toc-text">æ–‡ä»¶ä¸‹è½½</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot%E7%BC%93%E5%AD%98%E7%AE%A1%E7%90%86"><span class="toc-number">5.</span> <span class="toc-text">SpringBootç¼“å­˜ç®¡ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%93%E9%AA%8C%E9%BB%98%E8%AE%A4%E7%BC%93%E5%AD%98"><span class="toc-number">5.1.</span> <span class="toc-text">ä½“éªŒé»˜è®¤ç¼“å­˜</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD%E9%85%8D%E7%BD%AE"><span class="toc-number">5.1.1.</span> <span class="toc-text">åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAServer%E7%B1%BB"><span class="toc-number">5.1.2.</span> <span class="toc-text">åˆ›å»ºServerç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAController%E7%B1%BB"><span class="toc-number">5.1.3.</span> <span class="toc-text">åˆ›å»ºControllerç±»</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E5%90%AF%E5%8A%A8%E7%B1%BB%E4%B8%8A%E6%B7%BB%E5%8A%A0"><span class="toc-number">5.1.4.</span> <span class="toc-text">åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ </span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%8DService%E7%B1%BB%E7%9A%84%E6%9F%A5%E8%AF%A2%E6%96%B9%E6%B3%95%E6%B7%BB%E5%8A%A0"><span class="toc-number">5.1.5.</span> <span class="toc-text">å†Serviceç±»çš„æŸ¥è¯¢æ–¹æ³•æ·»åŠ </span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SpringBoot%E7%BC%93%E5%AD%98%E6%B3%A8%E8%A7%A3"><span class="toc-number">5.2.</span> <span class="toc-text">SpringBootç¼“å­˜æ³¨è§£</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Cacheable%E6%B3%A8%E8%A7%A3"><span class="toc-number">5.2.1.</span> <span class="toc-text">@Cacheableæ³¨è§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CacheEvict%E6%B3%A8%E8%A7%A3"><span class="toc-number">5.2.2.</span> <span class="toc-text">@CacheEvictæ³¨è§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Caching%E6%B3%A8%E8%A7%A3"><span class="toc-number">5.2.3.</span> <span class="toc-text">@Cachingæ³¨è§£</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CacheConfig%E6%B3%A8%E8%A7%A3"><span class="toc-number">5.2.4.</span> <span class="toc-text">@CacheConfigæ³¨è§£</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SpringBoot-Redis%E7%BC%93%E5%AD%98"><span class="toc-number">5.3.</span> <span class="toc-text">SpringBoot Redisç¼“å­˜</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E%E6%B3%A8%E8%A7%A3Redis%E7%BC%93%E5%AD%98%E5%AE%9E%E7%8E%B0"><span class="toc-number">5.3.1.</span> <span class="toc-text">åŸºäºæ³¨è§£Redisç¼“å­˜å®ç°</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0redis%E4%BE%9D%E8%B5%96-1"><span class="toc-number">5.3.1.1.</span> <span class="toc-text">æ·»åŠ redisä¾èµ–</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE-1"><span class="toc-number">5.3.1.2.</span> <span class="toc-text">æ–‡ä»¶é…ç½®</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%96%E5%86%99Service%E7%B1%BB"><span class="toc-number">5.3.1.3.</span> <span class="toc-text">ç¼–å†™Serviceç±»</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%96%E5%86%99Controller%E7%B1%BB"><span class="toc-number">5.3.1.4.</span> <span class="toc-text">ç¼–å†™Controllerç±»</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%AE%9E%E4%BD%93%E7%B1%BB"><span class="toc-number">5.3.1.5.</span> <span class="toc-text">ä¿®æ”¹å®ä½“ç±»</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8EAPI%E7%BC%93%E5%AD%98%E6%9C%BA%E5%88%B6"><span class="toc-number">5.4.</span> <span class="toc-text">åŸºäºAPIç¼“å­˜æœºåˆ¶</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAService%E7%B1%BB"><span class="toc-number">5.4.0.1.</span> <span class="toc-text">åˆ›å»ºServiceç±»</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Controller%E7%B1%BB%E6%96%B9%E6%B3%95"><span class="toc-number">5.4.0.2.</span> <span class="toc-text">Controllerç±»æ–¹æ³•</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Spring-Security"><span class="toc-number">6.</span> <span class="toc-text">Spring Security</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E8%AE%A4%E8%AF%81"><span class="toc-number">6.1.</span> <span class="toc-text">ç”¨æˆ·è‡ªå®šä¹‰è®¤è¯</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%86%85%E5%AD%98%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81"><span class="toc-number">6.1.1.</span> <span class="toc-text">å†…å­˜èº«ä»½è®¤è¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89WebSecurityConfigurerAdapter%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-number">6.1.1.1.</span> <span class="toc-text">è‡ªå®šä¹‰WebSecurityConfigurerAdapteré…ç½®ç±»</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JDBC%E8%AE%A4%E8%AF%81"><span class="toc-number">6.1.2.</span> <span class="toc-text">JDBCè®¤è¯</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BC%95%E5%85%A5%E4%BE%9D%E8%B5%96"><span class="toc-number">6.1.2.1.</span> <span class="toc-text">å¼•å…¥ä¾èµ–</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">6.1.2.2.</span> <span class="toc-text">é…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BE%9D%E6%AC%A1%E5%88%9B%E5%BB%BAMySQL%E8%A1%A8"><span class="toc-number">6.1.2.3.</span> <span class="toc-text">ä¾æ¬¡åˆ›å»ºMySQLè¡¨</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BC%96%E5%86%99%E9%85%8D%E7%BD%AE%E7%B1%BB"><span class="toc-number">6.1.2.4.</span> <span class="toc-text">ç¼–å†™é…ç½®ç±»</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UserDetailsService%E8%BA%AB%E4%BB%BD%E8%AE%A4%E8%AF%81"><span class="toc-number">6.2.</span> <span class="toc-text">UserDetailsServiceèº«ä»½è®¤è¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SpringBoot%E4%BB%BB%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="toc-number">7.</span> <span class="toc-text">SpringBootä»»åŠ¡ç®¡ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1"><span class="toc-number">7.1.</span> <span class="toc-text">å¼‚æ­¥ä»»åŠ¡</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B2%A1%E6%9C%89%E8%BF%94%E5%9B%9E%E5%80%BC%E7%9A%84%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1"><span class="toc-number">7.1.1.</span> <span class="toc-text">æ²¡æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%89%E8%BF%94%E5%9B%9E%E5%80%BC%E7%9A%84%E5%BC%82%E6%AD%A5%E4%BB%BB%E5%8A%A1"><span class="toc-number">7.1.2.</span> <span class="toc-text">æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡</span></a></li></ol></li></ol></li></ol></div></div></div></aside><main class="sidebar-translate" id="content"><div id="post"><article class="hty-card post-block" itemscope itemtype="https://schema.org/Article"><link itemprop="mainEntityOfPage" href="https://dbin.top/2022/03/02/%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF/Spring%20Boot%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span hidden itemprop="author" itemscope itemtype="https://schema.org/Person"><meta itemprop="name" content="è½èŠ±ç”Ÿ"><meta itemprop="description"></span><span hidden itemprop="publisher" itemscope itemtype="https://schema.org/Organization"><meta itemprop="name" content="å”¯è½èŠ±ç”Ÿ"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">Spring Boot å­¦ä¹ ç¬”è®°</h1><div class="post-meta"><div class="post-time" style="display:block"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-line"></use></svg></span> <time title="åˆ›å»ºæ—¶é—´ï¼š2022-03-02 00:27:57" itemprop="dateCreated datePublished" datetime="2022-03-02T00:27:57+08:00">2022-03-02</time><span class="post-meta-divider">-</span><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-calendar-2-line"></use></svg></span> <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-05-03 17:32:42" itemprop="dateModified" datetime="2022-05-03T17:32:42+08:00">2022-05-03</time></div><span class="post-count"><span class="post-symbolcount"><span class="post-meta-item-icon" title="æœ¬æ–‡å­—æ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-file-word-line"></use></svg></span> <span title="æœ¬æ–‡å­—æ•°">11.6k</span><span class="post-meta-divider">-</span><span class="post-meta-item-icon" title="é˜…è¯»æ—¶é•¿"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-timer-line"></use></svg></span> <span title="é˜…è¯»æ—¶é•¿">55m</span></span></span><span class="post-meta-divider">-</span><a href="#comment"><span class="post-meta-item-icon" title="è¯„è®ºæ•°"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-chat-3-line"></use></svg> <span class="waline-comment-count" id="/2022/03/02/%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF/Spring%20Boot%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"></span></span></a><div class="post-classify"><span class="post-category"> <span class="post-meta-item-icon" style="margin-right:3px;"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-folder-line"></use></svg></span><span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%AD%A6%E4%B9%A0/" style="--text-color:#007EFF" itemprop="url" rel="index"><span itemprop="text">å­¦ä¹ </span></a></span> > <span itemprop="about" itemscope itemtype="https://schema.org/Thing"><a class="category-item" href="/categories/%E5%AD%A6%E4%B9%A0/%E7%AC%94%E8%AE%B0/" style="--text-color:#28d8f7" itemprop="url" rel="index"><span itemprop="text">ç¬”è®°</span></a></span></span><span class="post-tag"><span class="post-meta-divider">-</span><a class="tag-item" href="/tags/Java/" style="--text-color:#FF1CAE"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Java</span></a><a class="tag-item" href="/tags/%E5%BC%80%E5%8F%91/" style="--text-color:blue"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">å¼€å‘</span></a><a class="tag-item" href="/tags/Servlet/" style="--text-color:#DAA520"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Servlet</span></a><a class="tag-item" href="/tags/%E5%90%8E%E7%AB%AF/" style="--text-color:#1E90FF"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">åç«¯</span></a><a class="tag-item" href="/tags/Spring-Boot/" style="--text-color:#228B22"><span class="post-meta-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-price-tag-3-line"></use></svg></span><span class="tag-name">Spring Boot</span></a></span></div></div></header><section class="post-body" itemprop="articleBody"><div class="post-content markdown-body" style="--smc-primary:#4fcde3;"><h2 id="ç¬¬ä¸€ä¸ªSpring-Booté¡¹ç›®"><a href="#ç¬¬ä¸€ä¸ªSpring-Booté¡¹ç›®" class="headerlink" title="ç¬¬ä¸€ä¸ªSpring Booté¡¹ç›®"></a>ç¬¬ä¸€ä¸ªSpring Booté¡¹ç›®</h2><h3 id="é…ç½®ä¾èµ–pom-xml"><a href="#é…ç½®ä¾èµ–pom-xml" class="headerlink" title="é…ç½®ä¾èµ–pom.xml"></a>é…ç½®ä¾èµ–<code>pom.xml</code></h3><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>project</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
         <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>modelVersion</span><span class="token punctuation">></span></span>4.0.0<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>modelVersion</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!--spring-boot-start-parentä¾èµ–ï¼Œçˆ¶é¡¹ç›®ä¾èµ–ç®¡ç†--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>parent</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-parent<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.1.3.RELEASE<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>relativePath</span><span class="token punctuation">/></span></span> <span class="token comment">&lt;!-- lookup parent from repository --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>parent</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>packaging</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>packaging</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>name</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>name</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>description</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>description</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>java.version</span><span class="token punctuation">></span></span>11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>java.version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--webæ¨¡å—ä¾èµ–å¯åŠ¨å™¨--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--æµ‹è¯•ç±»ä¾èµ–--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--çƒ­éƒ¨ç½²ä¾èµ–å¯åŠ¨å™¨--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--tomcatä¾èµ–--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-tomcat<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>provided<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!--Maven æ‰“åŒ…å·¥å…·æ’ä»¶--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>build</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugins</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-maven-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.6.4<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugins</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>build</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>project</span><span class="token punctuation">></span></span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="åˆ›å»ºä¸»ç¨‹åºå¯åŠ¨ç±»"><a href="#åˆ›å»ºä¸»ç¨‹åºå¯åŠ¨ç±»" class="headerlink" title="åˆ›å»ºä¸»ç¨‹åºå¯åŠ¨ç±»"></a>åˆ›å»º<code>ä¸»ç¨‹åºå¯åŠ¨ç±»</code></h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span></span><span class="token class-name">SpringApplication</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>autoconfigure<span class="token punctuation">.</span></span><span class="token class-name">SpringBootApplication</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@SpringBootApplication</span> <span class="token comment">//æ ‡è®°ä¸»ç¨‹åºå¯åŠ¨ç±»</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Chapter01Application</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//ä¸»ç¨‹åºå¯åŠ¨æ–¹æ³•</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Chapter01Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="åˆ›å»ºå¤„ç†ç±»"><a href="#åˆ›å»ºå¤„ç†ç±»" class="headerlink" title="åˆ›å»ºå¤„ç†ç±»"></a>åˆ›å»ºå¤„ç†ç±»</h3><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>chapter01<span class="token punctuation">.</span>controller</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">GetMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PostMapping</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>web<span class="token punctuation">.</span>bind<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">RestController</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RestController</span> <span class="token comment">//å°†å½“å‰ç±»ä½œä¸ºæ§åˆ¶å±‚ç»„ä»¶æ·»åŠ åˆ°Springå®¹å™¨ä¸­,ç±»ä¸­çš„æ‰€æœ‰æ–¹æ³•åªèƒ½è¿”å›Stringã€Objectã€Jsonç­‰å®ä½“å¯¹è±¡ï¼Œä¸èƒ½è·³è½¬åˆ°æ¨¡ç‰ˆé¡µé¢</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HelloController</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/hello"</span><span class="token punctuation">)</span><span class="token comment">//è®¾ç½®è®¿é—®è·¯å¾„å’Œæ–¹æ³•</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"hello Spring"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/hellos"</span><span class="token punctuation">)</span><span class="token comment">//Postæ–¹æ³•è·¯å¾„æ˜ å°„</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hellos</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"hello hello Spring"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤æ—¶è¿è¡Œé¡¹ç›®å°±å¯ä»¥è¯·æ±‚<code>localhost:ç«¯å£å·/hello</code>,å’Œ<code>localhost:ç«¯å£å·/hello</code></p>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨<code>@RequestMapping</code>æ³¨è§£ã€‚</p>
<p>å…³äº<code>@RequestMapping</code>æ³¨è§£è¿™é‡Œæœ‰ç›¸å…³è§£é‡Š<a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/651661">@RequestMappingæ³¨è§£çš„ä½¿ç”¨</a></p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/request"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RequestTest</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"hello0"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/hello1"</span><span class="token punctuation">)</span><span class="token comment">//è¿™é‡Œçš„è·¯å¾„ç›¸å½“äº@GetMappingçš„/request/hello1</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"hello1"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">"/hello2"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"hello2"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨<code>@ResponseStatus</code>æ³¨è§£å¯ä»¥å¿«é€Ÿå°†è¿”å›å¯¹è±¡çš„å„ç§å±æ€§è½¬æ¢ä¸ºJson</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@ResponseStatus</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ResponseTest</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/getuser"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">User</span> <span class="token function">getUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">User</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setId</span><span class="token punctuation">(</span><span class="token number">1234</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        user<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> user<span class="token punctuation">;</span><span class="token comment">//ç›´æ¥è¿”å›å¯¹è±¡ï¼Œä¼šè‡ªåŠ¨è½¬æ¢ä¸ºJson</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> name<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> id<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="IDEAçƒ­éƒ¨ç½²"><a href="#IDEAçƒ­éƒ¨ç½²" class="headerlink" title="IDEAçƒ­éƒ¨ç½²"></a>IDEAçƒ­éƒ¨ç½²</h3><p>æ·»åŠ çƒ­éƒ¨ç½²ä¾èµ–</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-devtools<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><font color='red'>1.</font>åœ¨IDEAçš„<code>File | Settings | Build, Execution, Deployment | Compiler</code>ä¸­æ‰¾åˆ°<code>Build project automatically</code>å‹¾é€‰ã€‚</p>
<p><font color='red'>2.</font>ä»»æ„ç•Œé¢æŒ‰ç»„åˆé”®<code>Ctrl+Shift+Alt+/</code>æ‰“å¼€Maintenanceé€‰é¡¹æ¡†ï¼Œæ‰“å¼€Registryé¡µé¢ï¼Œå‹¾é€‰<code>compiler.automake.allow.when.app.runing</code></p>
<p>å¦‚æœåœ¨ä¸Šä¸€æ­¥ä¸­æ²¡æœ‰æ‰¾åˆ°é€‰é¡¹å¯ä»¥åœ¨<code>File | Settings | Advanced Settings</code>ä¸­å‹¾é€‰<code>Allow auto-make to start even if developed application is currently running</code></p>
<p>æœ€åç‚¹å‡»è¿è¡Œ(æ˜¯runä¸æ˜¯debug)å°±å¯ä»¥ä½¿ç”¨çƒ­éƒ¨ç½²äº†</p>
<p><font color='blue'>tips:</font> å¦‚æœå‡ºç°è¿è¡Œæ¨¡å¼å¢é•¿ï¼Œè°ƒè¯•æ¨¡å¼å‡ºé”™ï¼Œå¯ä»¥å–æ¶ˆ<font color='red'>1</font>çš„å‹¾é€‰ï¼Œéœ€è¦çƒ­éƒ¨ç½²å¯åŠ¨æ—¶åœ¨é‡æ–°å‹¾é€‰ã€‚</p>
<h3 id="æµ‹è¯•ç±»çš„ä½¿ç”¨"><a href="#æµ‹è¯•ç±»çš„ä½¿ç”¨" class="headerlink" title="æµ‹è¯•ç±»çš„ä½¿ç”¨"></a>æµ‹è¯•ç±»çš„ä½¿ç”¨</h3><p>åœ¨<code>test</code>ä¸­ä¸ä¸»ç¨‹åºå¯åŠ¨ç±»ç›¸åŒçš„åŒ…ä¸‹åˆ›å»ºTestsç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>chapter01<span class="token punctuation">.</span>controller<span class="token punctuation">.</span></span><span class="token class-name">HelloController</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringRunner</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//æµ‹è¯•è¿è¡Œå™¨ï¼Œå¹¶åŠ è½½åˆ°SpringBootTestæµ‹è¯•æ³¨è§£</span>
<span class="token annotation punctuation">@SpringBootTest</span> <span class="token comment">//æ ‡è®°æµ‹è¯•å•å…ƒ</span>
<span class="token keyword">class</span> <span class="token class-name">Chapter01ApplicationTests</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//è‡ªåŠ¨åˆ›å»ºçš„å•å…ƒæµ‹è¯•æ–¹æ³•ç¤ºä¾‹</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">HelloController</span> helloController<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>helloController<span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œtestç±»ï¼Œå³å¯åœ¨æ§åˆ¶å°æŸ¥çœ‹åˆ°è¾“å‡ºhello</p>
<p><font color='red'>other</font></p>
<details>
    <summary>spring boot å„å±‚æ¬¡å›¾è§£</summary>
    <ul style="list-style-type:none">
        <li><img src="https://dbins.gitee.io/image/others/1.png" loading="lazy"></li>
    </ul>
</details>



<h2 id="Spring-Boot-æ ¸å¿ƒé…ç½®ä¸æ³¨è§£"><a href="#Spring-Boot-æ ¸å¿ƒé…ç½®ä¸æ³¨è§£" class="headerlink" title="Spring Boot æ ¸å¿ƒé…ç½®ä¸æ³¨è§£"></a>Spring Boot æ ¸å¿ƒé…ç½®ä¸æ³¨è§£</h2><h3 id="å…¨å±€é…ç½®æ–‡ä»¶application-properties-ä¸-application-yaml"><a href="#å…¨å±€é…ç½®æ–‡ä»¶application-properties-ä¸-application-yaml" class="headerlink" title="å…¨å±€é…ç½®æ–‡ä»¶application.properties ä¸ application.yaml"></a>å…¨å±€é…ç½®æ–‡ä»¶<code>application.properties</code> ä¸ <code>application.yaml</code></h3><p>å…¨å±€æ–‡ä»¶èƒ½å¯¹ä¸€äº›é»˜è®¤é…ç½®å€¼è¿›è¡Œä¿®æ”¹,spring bootä½¿ç”¨<code>application.properties</code> ä¸ <code>application.yaml</code>ä½œä¸ºå…¨å±€é…ç½®æ–‡ä»¶ï¼Œæ–‡ä»¶æ”¾åœ¨<code>src/main/resource</code>ç›®å½•æˆ–ç±»è·¯å¾„çš„<code>config</code></p>
<p>ä¸ºäº†åœ¨å†™é…ç½®æ—¶æœ‰ç›¸å…³æç¤ºï¼ŒåŠ å…¥é…ç½®ä¾èµ–ã€‚</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-configuration-processor<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="application-proprities"><a href="#application-proprities" class="headerlink" title="application.proprities"></a><code>application.proprities</code></h4><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#æœåŠ¡å™¨åº”ç»‘å®šåˆ°çš„ç½‘ç»œåœ°å€</span>
<span class="token attr-name">server.address</span><span class="token punctuation">=</span><span class="token attr-value">80</span>
<span class="token comment">#æœåŠ¡å™¨ HTTP ç«¯å£ã€‚</span>
<span class="token attr-name">server.port</span><span class="token punctuation">=</span><span class="token attr-value">8080 </span>
<span class="token comment">#JDBC é©±åŠ¨ç¨‹åºçš„å®Œå…¨é™å®šåã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ ¹æ® URL è‡ªåŠ¨æ£€æµ‹ã€‚</span>
<span class="token attr-name">spring.datasource.driver-class-name</span><span class="token punctuation">=</span><span class="token attr-value">com.mysql.jdbc.Driver</span>
<span class="token comment">#é™¤é»˜è®¤å€¼å¤–è¿˜ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ä½ç½®ã€‚</span>
<span class="token attr-name">spring.config.additional-location</span><span class="token punctuation">=</span>
<span class="token comment">#æ›¿æ¢é»˜è®¤å€¼çš„é…ç½®æ–‡ä»¶ä½ç½®</span>
<span class="token attr-name">spring.config.location</span><span class="token punctuation">=</span>
<span class="token comment">#é…ç½®æ–‡ä»¶åã€‚</span>
<span class="token attr-name">spring.config.name</span><span class="token punctuation">=</span><span class="token attr-value">application</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<p>åˆ›å»º<code>Pet</code>ç±»å’Œ<code>Person</code>ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pet</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> type<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token comment">//æ­¤å¤„ç•¥å†™to_stringæ–¹æ³•å’Œå„ä¸ªæˆå‘˜å˜é‡çš„getter,setter</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> family<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Pet</span> pet<span class="token punctuation">;</span>
    <span class="token comment">//æ­¤å¤„ç•¥å†™toStringæ–¹æ³•å’Œå„ä¸ªæˆå‘˜å˜é‡çš„getter,setter</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨<code>application.proprities</code>ä¸­é…ç½®</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">person.id</span><span class="token punctuation">=</span><span class="token attr-value">1</span>
<span class="token attr-name">person.name</span><span class="token punctuation">=</span><span class="token attr-value">tomcat</span>
<span class="token attr-name">person.famliy</span><span class="token punctuation">=</span><span class="token attr-value">father</span>
<span class="token attr-name">person.pet.type</span><span class="token punctuation">=</span><span class="token attr-value">dog</span>
<span class="token attr-name">person.pet.name</span><span class="token punctuation">=</span><span class="token attr-value">bob</span>
<span class="token comment">#å¦‚æœå­˜åœ¨Mapç±»å‹,åˆ™ä½¿ç”¨</span>
<span class="token comment">#person.map.key1=value2</span>
<span class="token comment">#person.map.key2=value2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–å†™æµ‹è¯•ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Chapter02ApplicationTests</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">Person</span> person<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œæµ‹è¯•ç±»ä¼šè‡ªåŠ¨è°ƒç”¨toString()æ–¹æ³•å¹¶è¾“å‡ºï¼Œå¯å‘ç°personçš„å„ç§å±æ€§å·²ç»èµ‹å€¼ã€‚</p>
<h4 id="application-yaml"><a href="#application-yaml" class="headerlink" title="application.yaml"></a><code>application.yaml</code></h4><p>ç¼–å†™ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@Component</span><span class="token comment">//æŠŠæ™®é€špojoå®ä¾‹åŒ–åˆ°springå®¹å™¨ä¸­</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"relation"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Relationship</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span>  map<span class="token punctuation">;</span> <span class="token comment">//å¯ä»¥å®šä¹‰map é”®å’Œå€¼çš„ç±»å‹ï¼Œæ¯”å¦‚String</span>
    <span class="token keyword">private</span> <span class="token class-name">ArrayList</span> <span class="token class-name">People</span><span class="token punctuation">;</span>
    <span class="token comment">//çœç•¥getter,setter,toString.</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é…ç½®<code>yaml</code>é‡åˆ°Mapæ—¶<code>:</code>Â·åè¦æœ‰ç©ºæ ¼ï¼Œé”®ä¸èƒ½ç”¨ä¸­æ–‡ï¼Œä½†æ˜¯å€¼å¯ä»¥ã€‚</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">relation</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> å…³ç³»å›¾1
  <span class="token comment">#è¿™ç§å½¢å¼çš„é…ç½®mapåœ¨é”®ã€å€¼ä¸­éƒ½ä¸èƒ½å‡ºç°è‹±æ–‡(åŠè§’)é€—å·å·,ä¸­æ–‡(å…¨è§’)å¯ä»¥,ä½†æ˜¯åœ¨é”®ä¸­çš„,?ç­‰å…¨è§’æˆ–åŠè§’ç¬¦å·ä¼šè¢«å¿½ç•¥</span>
  <span class="token key atrule">map</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token key atrule">y</span><span class="token punctuation">:</span> b<span class="token punctuation">,</span> <span class="token key atrule">w</span><span class="token punctuation">:</span> m<span class="token punctuation">,</span> <span class="token key atrule">b</span><span class="token punctuation">:</span> e<span class="token punctuation">&#125;</span>
  <span class="token key atrule">people</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> çˆ·çˆ·
    <span class="token punctuation">-</span> çˆ¸çˆ¸
    <span class="token punctuation">-</span> å¦ˆå¦ˆ
    <span class="token punctuation">-</span> å„¿å­
    <span class="token punctuation">-</span> å¤–å…¬<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ–è€…</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">relation</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> å…³ç³»å›¾1
  <span class="token comment">#è¿™ç§å½¢å¼çš„é…ç½®mapåœ¨é”®ã€å€¼ä¸­éƒ½ä¸èƒ½å‡ºç°è‹±æ–‡(åŠè§’)é€—å·å·,ä¸­æ–‡(å…¨è§’)å¯ä»¥,ä½†æ˜¯åœ¨é”®ä¸­çš„,?ç­‰å…¨è§’æˆ–åŠè§’ç¬¦å·ä¼šè¢«å¿½ç•¥</span>
  <span class="token key atrule">map</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token key atrule">y</span><span class="token punctuation">:</span> b<span class="token punctuation">,</span> <span class="token key atrule">w</span><span class="token punctuation">:</span> m<span class="token punctuation">,</span> <span class="token key atrule">b</span><span class="token punctuation">:</span> e<span class="token punctuation">&#125;</span>
  <span class="token key atrule">people</span><span class="token punctuation">:</span>
    çˆ¸çˆ¸<span class="token punctuation">,</span>
    å„¿å­<span class="token punctuation">,</span>
    çˆ·çˆ·<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æˆ–è€…</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">relation</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> å…³ç³»å›¾1
  <span class="token comment">#è¿™ç§å½¢å¼çš„é…ç½®mapåœ¨é”®ã€å€¼ä¸­éƒ½èƒ½å‡ºç°è‹±æ–‡(åŠè§’)é€—å·,åŒæ ·åœ¨é”®ä¸­ä¼šè¢«å¿½ç•¥</span>
  <span class="token key atrule">map</span><span class="token punctuation">:</span>
    <span class="token key atrule">y</span><span class="token punctuation">:</span> çˆ¸çˆ¸
    <span class="token key atrule">w</span><span class="token punctuation">:</span> m
    <span class="token key atrule">b</span><span class="token punctuation">:</span> e
  <span class="token key atrule">people</span><span class="token punctuation">:</span> <span class="token punctuation">[</span>çˆ¸çˆ¸<span class="token punctuation">,</span>çˆ·çˆ·<span class="token punctuation">,</span>å„¿å­<span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="é…ç½®æ–‡ä»¶å±æ€§å€¼çš„æ³¨å…¥"><a href="#é…ç½®æ–‡ä»¶å±æ€§å€¼çš„æ³¨å…¥" class="headerlink" title="é…ç½®æ–‡ä»¶å±æ€§å€¼çš„æ³¨å…¥"></a>é…ç½®æ–‡ä»¶å±æ€§å€¼çš„æ³¨å…¥</h3><p>åœ¨å‰é¢çš„ç¤ºä¾‹ä¸­ï¼Œä½¿ç”¨ <code>@Component</code> <code>@ConfigurationProperties(prefix = &quot;relation&quot;)</code>æ³¨å…¥å±æ€§å€¼ï¼Œé…ç½®æ–‡ä»¶ä¸­çš„å±æ€§éœ€è¦ä¸ç±»é‡Œé¢çš„æˆå‘˜å˜é‡çš„åç§°ä¸€</p>
<h4 id="ä½¿ç”¨-Valueæ³¨å…¥å±æ€§"><a href="#ä½¿ç”¨-Valueæ³¨å…¥å±æ€§" class="headerlink" title="ä½¿ç”¨@Valueæ³¨å…¥å±æ€§"></a>ä½¿ç”¨<code>@Value</code>æ³¨å…¥å±æ€§</h4><p>å¦‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>context<span class="token punctuation">.</span>properties<span class="token punctuation">.</span></span><span class="token class-name">ConfigurationProperties</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>stereotype<span class="token punctuation">.</span></span><span class="token class-name">Component</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">ArrayList</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>
<span class="token annotation punctuation">@Component</span>
<span class="token comment">//@ConfigurationProperties(prefix = "relation")ä¸ä½¿ç”¨è¯¥æ³¨è§£é…ç½®</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Relationship</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"$&#123;relation.name&#125;"</span><span class="token punctuation">)</span><span class="token comment">//ä½¿ç”¨@Valueæ³¨å…¥</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">></span></span>  map<span class="token punctuation">;</span><span class="token comment">//@Valueä¸èƒ½ç”¨äºå¤æ‚ç±»å‹</span>
    <span class="token keyword">private</span> <span class="token class-name">ArrayList</span> <span class="token class-name">People</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ä¸¤ç§æ³¨è§£å¯¹æ¯”"><a href="#ä¸¤ç§æ³¨è§£å¯¹æ¯”" class="headerlink" title="ä¸¤ç§æ³¨è§£å¯¹æ¯”"></a>ä¸¤ç§æ³¨è§£å¯¹æ¯”</h4><table>
<thead>
<tr>
<th align="center"></th>
<th align="left">@ConfigurationProperties</th>
<th>@Value</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1.åº•å±‚æ¡†æ¶</td>
<td align="left">Spring Boot</td>
<td>Spring</td>
</tr>
<tr>
<td align="center">2.åŠŸèƒ½</td>
<td align="left">æ‰¹é‡æ³¨å…¥æ–‡ä»¶ä¸­çš„å±æ€§</td>
<td>å•ä¸ªæ³¨å…¥</td>
</tr>
<tr>
<td align="center">3.setteræ–¹æ³•</td>
<td align="left">éœ€è¦</td>
<td>ä¸éœ€è¦</td>
</tr>
<tr>
<td align="center">4.å¤æ‚ç±»å‹å±æ€§æ³¨å…¥</td>
<td align="left">æ”¯æŒ</td>
<td>ä¸æ”¯æŒ</td>
</tr>
<tr>
<td align="center">5.æ¾æ•£ç»‘å®š</td>
<td align="left">æ”¯æŒ</td>
<td>ä¸æ”¯æŒ</td>
</tr>
<tr>
<td align="center">6.JSR303 æ•°æ®æ ¡éªŒ</td>
<td align="left">æ”¯æŒ</td>
<td>ä¸æ”¯æŒ</td>
</tr>
<tr>
<td align="center">7.SpELlè¡¨è¾¾å¼</td>
<td align="left">ä¸æ”¯æŒ</td>
<td>æ”¯æŒ</td>
</tr>
</tbody></table>
<p><em><strong>4</strong></em></p>
<p>@ConfigurationPropertiesæ”¯æŒå¤æ‚æ•°æ®ç±»å‹(å¦‚ï¼šMap,List)çš„å±æ€§æ³¨å…¥</p>
<p>@Value åªæ”¯æŒåŸºæœ¬æ•°æ®ç±»å‹</p>
<p><em><strong>5</strong></em></p>
<p>  @ConfigurationProperties æ³¨å…¥é…ç½®æ–‡ä»¶å±æ€§æ—¶ï¼Œæ”¯æŒæ¾æ•£ç»‘å®šè¯­æ³•,å¯¹å¤§å°å†™å­—æ¯ä¸æ•æ„Ÿã€‚</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">PERSON.id</span><span class="token punctuation">=</span><span class="token attr-value">1</span>
<span class="token attr-name">person.name</span><span class="token punctuation">=</span><span class="token attr-value">tomcat</span>
<span class="token attr-name">person.Famliy</span><span class="token punctuation">=</span><span class="token attr-value">father</span>
<span class="token attr-name">person.pet.Type</span><span class="token punctuation">=</span><span class="token attr-value">dog</span>
<span class="token attr-name">person.PET.Name</span><span class="token punctuation">=</span><span class="token attr-value">bob</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>@Valuesä½¿ç”¨æ¾æ•£ç»‘å®šè¯­æ³•æ— æ•ˆ</p>
<p><em><strong>6</strong></em></p>
<p> @ConfigurationProperties æ”¯æŒJSR303 æ•°æ®æ ¡éªŒ,å…¶ä¸»è¦ä½œç”¨æ—¶æ ¡éªŒé…ç½®æ–‡ä»¶ä¸­æ³¨å…¥å¯¹åº”Beanå±æ€§çš„å€¼æ˜¯å¦ç¬¦åˆç›¸å…³è§„åˆ™ã€‚å¦‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"person"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@Validated</span> <span class="token comment">//å¼•å…¥Springæ¡†æ¶æ”¯æŒçš„æ•°æ®æ ¡éªŒè§„åˆ™ï¼Œåªæœ‰åœ¨å¼•å…¥è¯¥æ ‡æ³¨æ—¶é…ç½®é”™è¯¯æ‰ä¼šæŠ¥é”™</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Email</span> <span class="token comment">//è‹¥é…ç½®emailçš„æ ¼å¼ä¸æ˜¯é‚®ç®±æ ¼å¼åˆ™ä¼šæŠ¥é”™</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><em><strong>7</strong></em></p>
<p>@Value æ³¨è§£åœ¨æ³¨å…¥æ˜¯æ”¯æŒSpELè¡¨è¾¾å¼,å³â€#{xx}â€</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">"#&#123;5*5&#125;"</span><span class="token punctuation">)</span><span class="token comment">//ç›´æ¥ä½¿ç”¨SpELè¡¨è¾¾å¼ç›´æ¥ä¸ºå±æ€§æ³¨å…¥å€¼</span>
<span class="token keyword">private</span> <span class="token keyword">int</span> number<span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="è‡ªå®šä¹‰é…ç½®"><a href="#è‡ªå®šä¹‰é…ç½®" class="headerlink" title="è‡ªå®šä¹‰é…ç½®"></a>è‡ªå®šä¹‰é…ç½®</h3><p>å…¨å±€æ–‡ä»¶ç”±spring bootè‡ªåŠ¨åŠ è½½é…ç½®ï¼Œè€Œè‡ªå®šä¹‰çš„é…ç½®æ–‡ä»¶spring bootæ˜¯æ— æ³•è‡ªåŠ¨è¯†åˆ«çš„ï¼Œéœ€è¦æ‰‹åŠ¨åŠ è½½ã€‚</p>
<h4 id="ä½¿ç”¨-PropertySourceåŠ è½½é…ç½®æ–‡ä»¶"><a href="#ä½¿ç”¨-PropertySourceåŠ è½½é…ç½®æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨@PropertySourceåŠ è½½é…ç½®æ–‡ä»¶"></a>ä½¿ç”¨@PropertySourceåŠ è½½é…ç½®æ–‡ä»¶</h4><p>å¦‚ï¼š</p>
<p>åœ¨resourceä¸‹åˆ›å»ºmyconfigç›®å½•ï¼Œå†åœ¨å…¶ä¸­åˆ›å»ºtestConfigTest.properties</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">config1</span><span class="token punctuation">:</span>
<span class="token attr-name">config1.name</span><span class="token punctuation">=</span><span class="token attr-value">Config Test</span>
<span class="token attr-name">config1.id</span><span class="token punctuation">=</span><span class="token attr-value">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token comment">//è‡ªå®šä¹‰é…ç½®ç±»</span>
<span class="token annotation punctuation">@PropertySource</span><span class="token punctuation">(</span><span class="token string">"classpath:myConfig/testConfigTest.properties"</span><span class="token punctuation">)</span><span class="token comment">//æŒ‡å®šé…ç½®æ–‡ä»¶çš„ä½ç½®</span>
<span class="token annotation punctuation">@EnableConfigurationProperties</span><span class="token punctuation">(</span><span class="token class-name">Config01</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//å¼€å¯å¯¹åº”é…ç½®ç±»çš„å±æ€§æ³¨å…¥</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"config1"</span><span class="token punctuation">)</span><span class="token comment">//æŒ‡å®šé…ç½®æ–‡ä»¶æ³¨å…¥å±æ€§å‰ç¼€</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Config01</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> id<span class="token punctuation">;</span>
    <span class="token comment">//çœç•¥setter,getter,toString</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>tips</code> å¦‚è¿‡ä¸ä½¿ç”¨<code>Configuration</code> æ³¨è§£ï¼Œè€Œä½¿ç”¨<code>Component</code>åˆ™<code>@EnableConfigurationProperties(Config01.class)</code>å¯ä»¥çœç•¥ã€‚</p>
<h4 id="ä½¿ç”¨-ImportResourceåŠ è½½XMLé…ç½®æ–‡ä»¶"><a href="#ä½¿ç”¨-ImportResourceåŠ è½½XMLé…ç½®æ–‡ä»¶" class="headerlink" title="ä½¿ç”¨@ImportResourceåŠ è½½XMLé…ç½®æ–‡ä»¶"></a>ä½¿ç”¨@ImportResourceåŠ è½½XMLé…ç½®æ–‡ä»¶</h4><p>1åˆ›å»ºä¸€ä¸ªMyServiceç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyService</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"hello ?"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>2åœ¨resourceæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºbeans.xml</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>beans</span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span>
       <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!--é…ç½®myService,classä¸ºå®Œæ•´åŒ…è·¯å¾„--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>bean</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>myService<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.itheima.config.MyService<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>beans</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>3åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ @ImportResource(â€œclasspath:myConfig&#x2F;beans.xmlâ€)</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//classpathè¡¨ç¤ºåœ¨resourceä¸‹çš„myConfigæ–‡ä»¶å¤¹ä¸‹çš„beans.xmlï¼Œè¿™ä¸€æ­¥å¿…é¡»è¦æœ‰</span>
<span class="token annotation punctuation">@ImportResource</span><span class="token punctuation">(</span><span class="token string">"classpath:myConfig/beans.xml"</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootApplication</span> <span class="token comment">//æ ‡è®°ä¸»ç¨‹åºå¯åŠ¨ç±»</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Chapter01Application</span><span class="token punctuation">&#123;</span>
    <span class="token comment">//.......</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>4ä½¿ç”¨æµ‹è¯•ç±»æµ‹è¯•</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Chapter02ApplicationTests</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name"><span class="token namespace">com<span class="token punctuation">.</span>itheima<span class="token punctuation">.</span>config<span class="token punctuation">.</span></span>MyService</span> myService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token comment">//è¿™é‡Œå¯ä»¥ä½¿ç”¨å®Œæ•´è·¯å¾„ï¼Œé¿å…æŠ¥é”™</span>
    <span class="token keyword">private</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span>ApplicationContext</span> applicationContext<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//æŸ¥çœ‹æ˜¯å¦æœ‰idä¸ºmyServiceçš„ç»„ä»¶</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>applicationContext<span class="token punctuation">.</span><span class="token function">containsBean</span><span class="token punctuation">(</span><span class="token string">"myService"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>myService<span class="token punctuation">.</span><span class="token function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ä½¿ç”¨-Configurationç¼–å†™è‡ªå®šä¹‰é…ç½®ç±»"><a href="#ä½¿ç”¨-Configurationç¼–å†™è‡ªå®šä¹‰é…ç½®ç±»" class="headerlink" title="ä½¿ç”¨@Configurationç¼–å†™è‡ªå®šä¹‰é…ç½®ç±»"></a>ä½¿ç”¨@Configurationç¼–å†™è‡ªå®šä¹‰é…ç½®ç±»</h4><p>å–æ¶ˆå‰é¢çš„ç¬¬äºŒç¬¬ä¸‰é…ç½®ï¼Œç¼–å†™é…ç½®ç±»MyConfig</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token comment">//å®šä¹‰è¯¥ç±»ä¸ºé…ç½®ç±»</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyConfig</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Bean</span><span class="token comment">//è¿”å›å€¼å¯¹è±¡ä½œä¸ºç»„ä»¶æ·»åŠ åˆ°Springå®¹å™¨ä¸­ï¼Œç»„ä»¶åé»˜è®¤ä¸ºæ–¹æ³•åã€‚</span>
    <span class="token keyword">public</span> <span class="token class-name">MyService</span> <span class="token function">myService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">MyService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œå‰é¢ç¼–å†™çš„æµ‹è¯•ç±»ï¼Œå¯ä»¥çœ‹åˆ°é…ç½®æˆåŠŸã€‚</p>
<h3 id="Profileå¤šç¯å¢ƒé…ç½®"><a href="#Profileå¤šç¯å¢ƒé…ç½®" class="headerlink" title="Profileå¤šç¯å¢ƒé…ç½®"></a>Profileå¤šç¯å¢ƒé…ç½®</h3><h4 id="ä½¿ç”¨Profileæ–‡ä»¶"><a href="#ä½¿ç”¨Profileæ–‡ä»¶" class="headerlink" title="ä½¿ç”¨Profileæ–‡ä»¶"></a>ä½¿ç”¨Profileæ–‡ä»¶</h4><p>é…ç½®æ–‡ä»¶æ–‡ä»¶åæ»¡è¶³<code>application-&#123;profile&#125;.properties</code> <code>application-&#123;profile&#125;.yaml</code>ä¹Ÿå¯ä»¥</p>
<p>å¦‚åœ¨resourceç›®å½•åˆ›å»º</p>
<p>application-test.properties</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">server.port</span><span class="token punctuation">=</span><span class="token attr-value">8080</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>application-dev.properties</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">server.port</span><span class="token punctuation">=</span><span class="token attr-value">8081</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>application-prod.properties</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">server.port</span><span class="token punctuation">=</span><span class="token attr-value">8082</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>åœ¨application.propertiesä¸­é…ç½®</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">spring.profiles.active</span><span class="token punctuation">=</span><span class="token attr-value">dev</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>è¿è¡Œå¯åŠ¨ç±»ï¼Œåˆ™å¯ä»¥æŸ¥çœ‹ç›¸å…³ç«¯å£çš„å˜åŒ–ã€‚</p>
<h4 id="ä½¿ç”¨-Profileæ³¨è§£"><a href="#ä½¿ç”¨-Profileæ³¨è§£" class="headerlink" title="ä½¿ç”¨@Profileæ³¨è§£"></a>ä½¿ç”¨@Profileæ³¨è§£</h4><p>åˆ›å»ºæ¥å£ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DBConnector</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>åˆ›å»ºä¸‰ä¸ªç±»å®ç°æ¥å£</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">"dev"</span><span class="token punctuation">)</span><span class="token comment">//æŒ‡å®šå¤šç¯å¢ƒé…ç½®ç±»æ ‡è¯†</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DevDBConnector</span> <span class="token keyword">implements</span> <span class="token class-name">DBConnector</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Now is DEV development"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">"prod"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ProdDBConnector</span> <span class="token keyword">implements</span> <span class="token class-name">DBConnector</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Now is Prod development"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@Profile</span><span class="token punctuation">(</span><span class="token string">"test"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestDBConnector</span> <span class="token keyword">implements</span> <span class="token class-name">DBConnector</span><span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>

    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨application.propertiesä¸­æ›´æ”¹æŒ‡å®šçš„å¤šç¯å¢ƒé…ç½®æ–‡ä»¶ï¼Œè¿è¡Œæµ‹è¯•ç›¸å…³åˆ™ä¼šå‡ºç°ä¸åŒçš„ç»“æœã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">class</span> <span class="token class-name">SpringWebApplicationTests</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">DBConnector</span> dbConnector<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">void</span> <span class="token function">contextLoads</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        dbConnector<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="éšæœºå€¼è®¾ç½®ä»¥åŠå‚æ•°å¼•ç”¨"><a href="#éšæœºå€¼è®¾ç½®ä»¥åŠå‚æ•°å¼•ç”¨" class="headerlink" title="éšæœºå€¼è®¾ç½®ä»¥åŠå‚æ•°å¼•ç”¨"></a>éšæœºå€¼è®¾ç½®ä»¥åŠå‚æ•°å¼•ç”¨</h4><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#éšæœºå­—ç¬¦ä¸²</span>
<span class="token attr-name">my.string</span> <span class="token punctuation">=</span> <span class="token attr-value">$&#123;random.value&#125;</span>
<span class="token comment">#éšæœºæ•´æ•°</span>
<span class="token attr-name">my.number</span> <span class="token punctuation">=</span> <span class="token attr-value">$&#123;random.int&#125;</span>
<span class="token comment">#éšæœºLongå‹æ•´æ•°</span>
<span class="token attr-name">my.longnumber</span> <span class="token punctuation">=</span> <span class="token attr-value">$&#123;random.long&#125;</span>
<span class="token comment">#éšæœºUUID</span>
<span class="token attr-name">my.uuid</span> <span class="token punctuation">=</span> <span class="token attr-value">$&#123;random.uuid&#125;</span>
<span class="token comment">#å°äº10çš„æ•´æ•°</span>
<span class="token attr-name">my.numberlessten</span> <span class="token punctuation">=</span> <span class="token attr-value">$&#123;random.int(10)&#125;</span>
<span class="token comment">#1024-65536ä¹‹é—´çš„æ•°</span>
<span class="token attr-name">mu.numberinrangs</span> <span class="token punctuation">=</span> <span class="token attr-value">$&#123;random.int[1024,65536]&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¾‹å¦‚ï¼š</p>
<p>åˆ›å»ºç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token comment">//ä½¿ç”¨å…¨å±€æ–‡ä»¶å¯ä»¥ä¸ç”¨æŒ‡å®šé…ç½®æ–‡ä»¶ä½ç½®ç­‰</span>
<span class="token comment">//@PropertySource("classpath:")//æŒ‡å®šé…ç½®æ–‡ä»¶çš„ä½ç½®</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"boy"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Boy</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> uuid<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> description<span class="token punctuation">;</span>
    <span class="token comment">//çœç•¥setter</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œä½¿ç”¨yamlï¼Œå¦‚æœä½¿ç”¨propertieså¯èƒ½ä¸­æ–‡ä¹±ç ï¼Œè§£å†³æ–¹æ¡ˆå¯ç™¾åº¦</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"><span class="token key atrule">boy</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span>random.value<span class="token punctuation">&#125;</span>
  <span class="token key atrule">age</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span>random.int<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">20</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>
  <span class="token key atrule">uuid</span><span class="token punctuation">:</span> $<span class="token punctuation">&#123;</span>random.uuid<span class="token punctuation">&#125;</span>
  <span class="token key atrule">description</span><span class="token punctuation">:</span> ä¸€ä¸ªå«$<span class="token punctuation">&#123;</span>boy.name<span class="token punctuation">&#125;</span>çš„ç”·å­©çš„UUIDæ˜¯$<span class="token punctuation">&#123;</span>boy.uuid<span class="token punctuation">&#125;</span>ä»–å·²ç»$<span class="token punctuation">&#123;</span>boy.age<span class="token punctuation">&#125;</span>å²äº†.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<details>
    <summary>properties</summary>
    <ul style="list-style-type:none">
        <li>boy.name = ${random.value}</li>
        <li>boy.age = ${random.int[10,20]}</li>
        <li>boy.uuid = ${random.uuid}</li>
        <li>boy.description = ä¸€ä¸ªå«:${boy.name}çš„ç”·å­©çš„UUIDæ˜¯${boy.uuid}ä»–å·²ç»${boy.age}å²äº†.</li>
    </ul>
</details>
## SpringBootæ•°æ®è®¿é—®

<p>Springæä¾›äº†ç”¨äºç®€åŒ–æ•°æ®åº“è®¿é—®ã€æ”¯æŒäº‘æœåŠ¡çš„å¼€æºæ¡†æ¶Spring Dataã€‚å…¶æä¾›äº†å„ç§ç±»å‹æ•°æ®åº“çš„æ”¯æŒï¼ŒSpringBootå¯¹Dataæ”¯æŒçš„æ•°æ®åº“è¿›è¡Œæ•´åˆç®¡ç†ï¼Œæä¾›äº†å„ç§ä¾èµ–å¯åŠ¨å™¨ã€‚</p>
<table>
<thead>
<tr>
<th align="left">åç§°</th>
<th align="left">æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td align="left">spring-boot-starter-data-jpa</td>
<td align="left">Spring Data JPA ä¸ Hibernateçš„å¯åŠ¨å™¨</td>
</tr>
<tr>
<td align="left">spring-boot-starter-data-mongodb</td>
<td align="left">MongoDBå’ŒSpring Data MongoDBçš„å¯åŠ¨å™¨</td>
</tr>
<tr>
<td align="left">spring-boot-starter-data-neo4j</td>
<td align="left">Neo4j å›¾æ•°æ®åº“å’Œ Spring Data Neo4jçš„å¯åŠ¨å™¨</td>
</tr>
<tr>
<td align="left">spring-boot-starter-data-radis</td>
<td align="left">Redisé”®å€¼æ•°æ®å‚¨å­˜ä¸Sping Data Redis å’Œ Jedis å®¢æˆ·ç«¯çš„å¯åŠ¨å™¨</td>
</tr>
</tbody></table>
<p>MyBatis é€‚é…äº†Spring Bootæ¡†æ¶,æä¾›äº† <code>mybatis-spring-boot-starter</code>ä¾èµ–å¯åŠ¨å™¨</p>
<p>ä½¿ç”¨Mybatisè®¿é—®æ•°æ®åº“</p>
<h3 id="Mybatis"><a href="#Mybatis" class="headerlink" title="Mybatis"></a>Mybatis</h3><h4 id="æ·»åŠ ä¾èµ–"><a href="#æ·»åŠ ä¾èµ–" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h4><p>åœ¨pom.xmlä¸­æ·»åŠ ä¾èµ–</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!-- MyBatisä¾èµ–å¯åŠ¨å™¨ --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.mybatis.spring.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mybatis-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.2.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!--é˜¿é‡Œå·´å·´Druidæ•°æ®æºä¾èµ–å¯åŠ¨å™¨--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.1.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- MySQLæ•°æ®åº“è¿æ¥é©±åŠ¨ --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="é…ç½®å‚æ•°"><a href="#é…ç½®å‚æ•°" class="headerlink" title="é…ç½®å‚æ•°"></a>é…ç½®å‚æ•°</h4><p>å…¨å±€æ–‡ä»¶<code>application.properties</code>é…ç½®</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/springbootdata?serverTimezone=UTC</span>
<span class="token attr-name">spring.datasource.username</span><span class="token punctuation">=</span>
<span class="token attr-name">spring.datasource.password</span><span class="token punctuation">=</span>
<span class="token attr-name">spring.datasource.type</span> <span class="token punctuation">=</span> <span class="token attr-value">com.alibaba.druid.pool.DruidDataSource</span>
<span class="token comment">#ä¸‹é¢çš„å‚æ•°éœ€è¦é…ç½®ç±»é…ç½®</span>
<span class="token attr-name">spring.datasource.initialSize</span><span class="token punctuation">=</span><span class="token attr-value">20</span>
<span class="token attr-name">spring.datasource.minIdle</span><span class="token punctuation">=</span><span class="token attr-value">10</span>
<span class="token attr-name">spring.datasource.maxActive</span><span class="token punctuation">=</span><span class="token attr-value">100</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åˆ›å»ºé…ç½®ç±»"><a href="#åˆ›å»ºé…ç½®ç±»" class="headerlink" title="åˆ›å»ºé…ç½®ç±»"></a>åˆ›å»ºé…ç½®ç±»</h4><p>SpringBootæä¾›çš„æ•°æ®æºè‡ªåŠ¨é…ç½®ç±»DataSourcePropertiesä¸­æ²¡æœ‰ä¸è¿™äº›å‚æ•°å¯¹åº”çš„é»˜è®¤å±æ€§ï¼Œæ‰€ä»¥éœ€è¦ç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰é…ç½®ç±»ã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataSourceConfig</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"spring.datasource"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">getDruid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åˆ›å»ºå’Œæ•°æ®åº“ä¸­æ•°æ®ç±»å‹å¯¹åº”çš„ç±»"><a href="#åˆ›å»ºå’Œæ•°æ®åº“ä¸­æ•°æ®ç±»å‹å¯¹åº”çš„ç±»" class="headerlink" title="åˆ›å»ºå’Œæ•°æ®åº“ä¸­æ•°æ®ç±»å‹å¯¹åº”çš„ç±»"></a>åˆ›å»ºå’Œæ•°æ®åº“ä¸­æ•°æ®ç±»å‹å¯¹åº”çš„ç±»</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Comment</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> author<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> a_id<span class="token punctuation">;</span>
    <span class="token comment">//çœç•¥getterï¼Œsetter,toString</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Article</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> title<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> content<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Comment</span><span class="token punctuation">></span></span> commentList<span class="token punctuation">;</span>
    <span class="token comment">//çœç•¥setter,getter,toString</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ä½¿ç”¨æ³¨è§£æ•´åˆMyBatis"><a href="#ä½¿ç”¨æ³¨è§£æ•´åˆMyBatis" class="headerlink" title="ä½¿ç”¨æ³¨è§£æ•´åˆMyBatis"></a>ä½¿ç”¨æ³¨è§£æ•´åˆMyBatis</h4><h5 id="åˆ›å»ºMapperæ¥å£æ–‡ä»¶"><a href="#åˆ›å»ºMapperæ¥å£æ–‡ä»¶" class="headerlink" title="åˆ›å»ºMapperæ¥å£æ–‡ä»¶"></a>åˆ›å»ºMapperæ¥å£æ–‡ä»¶</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">CommentMapper</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"select * from t_comment where id=#&#123;id&#125;;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">Comment</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token keyword">int</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Insert</span><span class="token punctuation">(</span><span class="token string">"insert into t_comment(id,content,author,a_id) values(#&#123;id&#125;,#&#123;content&#125;,#&#123;author&#125;,#&#123;a_id&#125;);"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">insertComment</span><span class="token punctuation">(</span><span class="token class-name">Comment</span> comment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Update</span><span class="token punctuation">(</span><span class="token string">"update t_comment set content=#&#123;content&#125; where id=#&#123;a_id&#125;;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">updateComment</span><span class="token punctuation">(</span><span class="token class-name">Comment</span> comment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Delete</span><span class="token punctuation">(</span><span class="token string">"delete from"</span> <span class="token operator">+</span>
            <span class="token string">" t_comment where id=#&#123;id&#125;;"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">deleteComment</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//ä½¿ç”¨å­˜å‚¨è¿‡ç¨‹</span>
    <span class="token annotation punctuation">@Select</span><span class="token punctuation">(</span><span class="token string">"&#123;call passed(#&#123;passId&#125;,#&#123;map.return_,mode=OUT,jdbcType=INTEGER&#125;)&#125;"</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Options</span><span class="token punctuation">(</span>statementType <span class="token operator">=</span> <span class="token class-name">StatementType</span><span class="token punctuation">.</span>CALLABLE<span class="token punctuation">)</span><span class="token comment">//è¿™æ®µè¯ä¸€å®šè¦åŠ ï¼Œå¦åˆ™æŠ¥æ²¡æœ‰è®¾ç½®å‚æ•°çš„é”™è¯¯ã€‚</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">passed</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span><span class="token class-name">Map</span> map<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="ä½¿ç”¨æµ‹è¯•ç±»æµ‹è¯•"><a href="#ä½¿ç”¨æµ‹è¯•ç±»æµ‹è¯•" class="headerlink" title="ä½¿ç”¨æµ‹è¯•ç±»æµ‹è¯•"></a>ä½¿ç”¨æµ‹è¯•ç±»æµ‹è¯•</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>chapter03<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">Comment</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>chapter03<span class="token punctuation">.</span>mapper<span class="token punctuation">.</span></span><span class="token class-name">CommentMapper</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span></span><span class="token class-name">Test</span><span class="token punctuation">;</span><span class="token comment">//å¯¼åŒ…ä¸è¦å¯¼æˆå¦å¤–ä¸€ä¸ªç›¸ä¼¼çš„åŒ…ã€‚</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>junit<span class="token punctuation">.</span>runner<span class="token punctuation">.</span></span><span class="token class-name">RunWith</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Autowired</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>boot<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span></span><span class="token class-name">SpringBootTest</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>test<span class="token punctuation">.</span>context<span class="token punctuation">.</span>junit4<span class="token punctuation">.</span></span><span class="token class-name">SpringRunner</span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token comment">//æµ‹è¯•è¿è¡Œå™¨ï¼Œå¹¶åŠ è½½åˆ°SpringBootTestæµ‹è¯•æ³¨è§£</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Chapter03ApplicationTests</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">CommentMapper</span> commentMapper<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectComment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">Comment</span> comment <span class="token operator">=</span> commentMapper<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>comment<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä»£ç ä¸­çš„åç§°å¯ä»¥ä¸æ•°æ®åº“ä¸­çš„ä¸€æ ·ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨é©¼å³°å‘½å,ç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ é©¼å³°åŒ¹é…æ˜ å°„è®¾ç½®</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">mybatis.configuration.map-underscore-to-camel-case</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="ä½¿ç”¨é…ç½®æ–‡ä»¶æ•´åˆMyBatis"><a href="#ä½¿ç”¨é…ç½®æ–‡ä»¶æ•´åˆMyBatis" class="headerlink" title="ä½¿ç”¨é…ç½®æ–‡ä»¶æ•´åˆMyBatis"></a>ä½¿ç”¨é…ç½®æ–‡ä»¶æ•´åˆMyBatis</h4><h4 id="åˆ›å»ºArticleMapperæ¥å£"><a href="#åˆ›å»ºArticleMapperæ¥å£" class="headerlink" title="åˆ›å»ºArticleMapperæ¥å£"></a>åˆ›å»ºArticleMapperæ¥å£</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Mapper</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ArticleMapper</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token class-name">Article</span> <span class="token function">selectArticle</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">updateArticle</span><span class="token punctuation">(</span><span class="token class-name">Article</span> article<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åˆ›å»ºæ˜ å°„æ–‡ä»¶"><a href="#åˆ›å»ºæ˜ å°„æ–‡ä»¶" class="headerlink" title="åˆ›å»ºæ˜ å°„æ–‡ä»¶"></a>åˆ›å»ºæ˜ å°„æ–‡ä»¶</h4><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8" ?></span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">mapper</span>
        <span class="token name">PUBLIC</span> <span class="token string">"-//mybatis.org//DTD Mapper 3.0//EN"</span>
        <span class="token string">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mapper</span> <span class="token attr-name">namespace</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.chapter03.mapper.ArticleMapper<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!--namespaceä¸ºArticleMapperæ‰€åœ¨ä½ç½®--></span>
    <span class="token comment">&lt;!-- 1ã€æŸ¥è¯¢æ–‡ç« è¯¦ç»†ï¼ˆåŒ…æ‹¬è¯„è®ºä¿¡æ¯ï¼‰ --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>select</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>selectArticle<span class="token punctuation">"</span></span> <span class="token attr-name">resultMap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>articleWithComment<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        SELECT a.*,c.id c_id,c.content c_content,c.author
        FROM t_article a,t_comment c
        WHERE a.id=c.a_id AND a.id = #&#123;id&#125;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>select</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!--å±æ€§æ˜ å°„--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>resultMap</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>articleWithComment<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Article<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>collection</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>commentList<span class="token punctuation">"</span></span> <span class="token attr-name">ofType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Comment<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>id<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>c_id<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>c_content<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>result</span> <span class="token attr-name">property</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>author<span class="token punctuation">"</span></span> <span class="token attr-name">column</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>author<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>collection</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>resultMap</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!-- 2ã€æ ¹æ®æ–‡ç« idæ›´æ–°æ–‡ç« ä¿¡æ¯ --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>update</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>updateArticle<span class="token punctuation">"</span></span> <span class="token attr-name">parameterType</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Article<span class="token punctuation">"</span></span> <span class="token punctuation">></span></span>
        UPDATE t_article
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>set</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title !=null and title !=<span class="token punctuation">'</span><span class="token punctuation">'</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                title=#&#123;title&#125;,
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>if</span> <span class="token attr-name">test</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content !=null and content !=<span class="token punctuation">'</span><span class="token punctuation">'</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
                content=#&#123;content&#125;
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>if</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>set</span><span class="token punctuation">></span></span>
        WHERE id=#&#123;id&#125;
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>update</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mapper</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="é…ç½®å…¨å±€æ–‡ä»¶ï¼Œé…ç½®XMLæ˜ å°„æ–‡ä»¶è·¯å¾„"><a href="#é…ç½®å…¨å±€æ–‡ä»¶ï¼Œé…ç½®XMLæ˜ å°„æ–‡ä»¶è·¯å¾„" class="headerlink" title="é…ç½®å…¨å±€æ–‡ä»¶ï¼Œé…ç½®XMLæ˜ å°„æ–‡ä»¶è·¯å¾„"></a>é…ç½®å…¨å±€æ–‡ä»¶ï¼Œé…ç½®XMLæ˜ å°„æ–‡ä»¶è·¯å¾„</h4><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#é…ç½®MyBatisçš„XMLæ–‡ä»¶è·¯å¾„</span>
<span class="token attr-name">mybatis.mapper-locations</span><span class="token punctuation">=</span><span class="token attr-value">classpath:mapper/*xml</span>
<span class="token comment">#é…ç½®XMLæ–‡ä»¶ä¸­æŒ‡å®šçš„å®ä½“ç±»åè·¯å¾„ç²¾ç¡®åˆ°åŒ…å</span>
<span class="token attr-name">mybatis.type-aliases-package</span><span class="token punctuation">=</span><span class="token attr-value">com.chapter03.domain</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">ArticleMapper</span> articleMapper<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">ArticleTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token class-name">Article</span> article <span class="token operator">=</span> articleMapper<span class="token punctuation">.</span><span class="token function">selectArticle</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>article<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="æ•´åˆJPA"><a href="#æ•´åˆJPA" class="headerlink" title="æ•´åˆJPA"></a>æ•´åˆJPA</h3><h4 id="æ·»åŠ ä¾èµ–-1"><a href="#æ·»åŠ ä¾èµ–-1" class="headerlink" title="æ·»åŠ ä¾èµ–"></a>æ·»åŠ ä¾èµ–</h4><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token comment">&lt;!--é˜¿é‡Œå·´å·´Druidæ•°æ®æºä¾èµ–å¯åŠ¨å™¨--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>druid-spring-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>1.1.10<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- MySQLæ•°æ®åº“è¿æ¥é©±åŠ¨ --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scope</span><span class="token punctuation">></span></span>runtime<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scope</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!--jpaä¾èµ–--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-data-jpa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="é…ç½®å‚æ•°-1"><a href="#é…ç½®å‚æ•°-1" class="headerlink" title="é…ç½®å‚æ•°"></a>é…ç½®å‚æ•°</h4><p>å…¨å±€æ–‡ä»¶<code>application.properties</code>é…ç½®</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/springbootdata?serverTimezone=UTC</span>
<span class="token attr-name">spring.datasource.username</span><span class="token punctuation">=</span>
<span class="token attr-name">spring.datasource.password</span><span class="token punctuation">=</span>
<span class="token attr-name">spring.datasource.type</span> <span class="token punctuation">=</span> <span class="token attr-value">com.alibaba.druid.pool.DruidDataSource</span>
<span class="token comment">#ä¸‹é¢çš„å‚æ•°éœ€è¦é…ç½®ç±»é…ç½®</span>
<span class="token attr-name">spring.datasource.initialSize</span><span class="token punctuation">=</span><span class="token attr-value">20</span>
<span class="token attr-name">spring.datasource.minIdle</span><span class="token punctuation">=</span><span class="token attr-value">10</span>
<span class="token attr-name">spring.datasource.maxActive</span><span class="token punctuation">=</span><span class="token attr-value">100</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åˆ›å»ºé…ç½®ç±»-1"><a href="#åˆ›å»ºé…ç½®ç±»-1" class="headerlink" title="åˆ›å»ºé…ç½®ç±»"></a>åˆ›å»ºé…ç½®ç±»</h4><p>SpringBootæä¾›çš„æ•°æ®æºè‡ªåŠ¨é…ç½®ç±»DataSourcePropertiesä¸­æ²¡æœ‰ä¸è¿™äº›å‚æ•°å¯¹åº”çš„é»˜è®¤å±æ€§ï¼Œæ‰€ä»¥éœ€è¦ç¼–å†™ä¸€ä¸ªè‡ªå®šä¹‰é…ç½®ç±»ã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DataSourceConfig</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"spring.datasource"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">DataSource</span> <span class="token function">getDruid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">DruidDataSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ç¼–å†™å®ä½“ç±»"><a href="#ç¼–å†™å®ä½“ç±»" class="headerlink" title="ç¼–å†™å®ä½“ç±»"></a>ç¼–å†™å®ä½“ç±»</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span><span class="token comment">//import lombok.Data; è‡ªåŠ¨é…ç½®setterå’Œgetter</span>
<span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">)</span><span class="token comment">//å®ä½“ç±»ä¸testè¡¨å¯¹åº”ã€‚</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JpaTest</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Id</span><span class="token comment">//@Idæ ‡è¯†è¿™æˆå‘˜å˜é‡æ˜¯ä¸»é”®ã€‚</span>
	<span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span>IDENTITY<span class="token punctuation">)</span> <span class="token comment">//ä¸»é”®ç”Ÿæˆç­–ç•¥,å¯ä»¥çœç•¥</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"mes"</span><span class="token punctuation">)</span><span class="token comment">//@Columnæ ‡æ³¨æ ‡è¯†è¯¥æˆå‘˜å˜é‡å’Œæ•°æ®è¡¨ä¸­çš„å­—æ®µåç›¸å¯¹åº”</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"date"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> date<span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>@GeneratedValue</code>ä¸»é”®ç”Ÿæˆç­–ç•¥æœ‰ï¼š<code>TABLE</code>(ä½¿ç”¨ä¸€ä¸ªç‰¹å®šçš„è¡¨ä¿å­˜ä¸»é”®),<code>SEQUENCE</code> ä¸æ”¯æŒä¸»é”®è‡ªåŠ¨å¢é•¿çš„æ•°æ®åº“ä¸»é”®ç”Ÿæˆç­–ç•¥, <code>IDENTITY</code>ä¸»é”®è‡ªå¢ï¼Œ<code>AUTO</code>è‡ªåŠ¨é€‰æ‹©ã€‚</p>
<h4 id="ç¼–å†™Repositoryæ¥å£"><a href="#ç¼–å†™Repositoryæ¥å£" class="headerlink" title="ç¼–å†™Repositoryæ¥å£"></a>ç¼–å†™Repositoryæ¥å£</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token comment">//&lt;JpaTest,String>JpaTestæ ‡è¯†å®ä½“ç±»ï¼ŒStringè¡¨ç¤ºä¸»é”®ç±»å‹ã€‚</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">DiscussRepository</span> <span class="token keyword">extends</span> <span class="token class-name">JpaRepository</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> <span class="token function">findByDateNotNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//JPAæ”¯æŒçš„æ–¹æ³•åå…³é”®è¯æŸ¥è¯¢</span>
    <span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span><span class="token string">"select c from test c where c.id=?1"</span><span class="token punctuation">)</span><span class="token comment">//é€šè¿‡@Queryæ³¨è§£å¼•å…¥SQLè¯­å¥,ç”¨äºåˆ†é¡µæŸ¥è¯¢.</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> <span class="token function">getTestPaged</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token class-name">Pageable</span> pageable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"select * from test where test.id=?1"</span><span class="token punctuation">,</span>nativeQuery <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token comment">//æ”¯æŒåŸç”Ÿçš„SQLè¯­å¥æŸ¥è¯¢</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> <span class="token function">getTestPage2</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span><span class="token class-name">Pageable</span> pageable<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Transactional</span><span class="token comment">//æ”¯æŒäº‹åŠ¡ç®¡ç†</span>
    <span class="token annotation punctuation">@Modifying</span><span class="token comment">//æ”¯æŒæ•°æ®å˜æ›´</span>
    <span class="token annotation punctuation">@Query</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">"update test c set c.message=?1 where c.id=?2"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">update</span><span class="token punctuation">(</span><span class="token class-name">String</span> message<span class="token punctuation">,</span><span class="token class-name">String</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010918876/article/details/80434790">Spring Data JPA åœ¨æ–¹æ³•åå…³é”®å­—</a></p>
<p>æµ‹è¯•æ•ˆæœ</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span>
<span class="token keyword">private</span> <span class="token class-name">DiscussRepository</span> repository<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Test</span>
<span class="token keyword">void</span> <span class="token class-name">TestJpa</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> optional <span class="token operator">=</span> repository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token string">"1234"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>optional<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> repository<span class="token punctuation">.</span><span class="token function">findByDateNotNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DiscussRepository</span> repository<span class="token punctuation">;</span>
<span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token class-name">TestJpa2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//ä½¿ç”¨Exampleç²¾å‡†åŒ¹é…ç»“æœ</span>
        <span class="token class-name">JpaTest</span> jpaTest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JpaTest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jpaTest<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span><span class="token string">"23412"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Example</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> example <span class="token operator">=</span> <span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>jpaTest<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> repository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>example<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">JpaTest</span> j<span class="token operator">:</span>list<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
		<span class="token comment">//ä½¿ç”¨Exampleæ¨¡ç³ŠåŒ¹é…ç»“æœ</span>
        <span class="token class-name">ExampleMatcher</span> matcher <span class="token operator">=</span> <span class="token class-name">ExampleMatcher</span><span class="token punctuation">.</span><span class="token function">matching</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">withMatcher</span><span class="token punctuation">(</span><span class="token string">"message"</span><span class="token punctuation">,</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Example</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> example1 <span class="token operator">=</span> <span class="token class-name">Example</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>jpaTest<span class="token punctuation">,</span>matcher<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> list1 <span class="token operator">=</span> repository<span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span>example1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">JpaTest</span> j<span class="token operator">:</span>list1<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å†ä¸‹é¢è¿™ä¸ªç±»ä¸­æœ‰æ›´å¤šçš„åŒ¹é…è§„åˆ™ã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token keyword">static</span> <span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>domain<span class="token punctuation">.</span></span><span class="token class-name">ExampleMatcher<span class="token punctuation">.</span>GenericPropertyMatchers</span><span class="token punctuation">.</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="æ•´åˆRedis"><a href="#æ•´åˆRedis" class="headerlink" title="æ•´åˆRedis"></a>æ•´åˆRedis</h3><p>Redis æ˜¯ä¸€ä¸ªå¼€æºï¼ˆBSDè®¸å¯ï¼‰çš„ã€å†…å­˜ä¸­çš„æ•°æ®ç»“æ„å­˜å‚¨ç³»ç»Ÿï¼Œå®ƒå¯ä»¥ç”¨ä½œæ•°æ®åº“ã€ç¼“å­˜å’Œæ¶ˆæ¯ä¸­é—´ä»¶ï¼Œå¹¶æä¾›å¤šç§è¯­è¨€çš„APIã€‚</p>
<h4 id="ä¸‹è½½å®‰è£…å¼€å¯Redis"><a href="#ä¸‹è½½å®‰è£…å¼€å¯Redis" class="headerlink" title="ä¸‹è½½å®‰è£…å¼€å¯Redis"></a>ä¸‹è½½å®‰è£…å¼€å¯Redis</h4><p><a target="_blank" rel="noopener" href="https://github.com/tporadowski/redis/releases">Releases Â· tporadowski&#x2F;redis Â· GitHub</a></p>
<p>ä¸‹è½½å¯¹åº”ç‰ˆæœ¬çš„zipæ–‡ä»¶å¹¶è§£å‹,ç‚¹å‡»redis-server.exeå°±å¯ä»¥è¿è¡ŒredisæœåŠ¡.</p>
<h4 id="æ·»åŠ redisä¾èµ–"><a href="#æ·»åŠ redisä¾èµ–" class="headerlink" title="æ·»åŠ redisä¾èµ–"></a>æ·»åŠ redisä¾èµ–</h4><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="æ–‡ä»¶é…ç½®"><a href="#æ–‡ä»¶é…ç½®" class="headerlink" title="æ–‡ä»¶é…ç½®"></a>æ–‡ä»¶é…ç½®</h4><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#æœåŠ¡å™¨åœ°å€</span>
<span class="token attr-name">spring.redis.host</span><span class="token punctuation">=</span><span class="token attr-value">127.0.0.1</span>
<span class="token comment">#ç«¯å£</span>
<span class="token attr-name">spring.redis.port</span><span class="token punctuation">=</span><span class="token attr-value">6379</span>
<span class="token comment">#å¯†ç é»˜è®¤ç©º</span>
<span class="token attr-name">spring.redis.password</span><span class="token punctuation">=</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åˆ›å»ºå®ä½“ç±»"><a href="#åˆ›å»ºå®ä½“ç±»" class="headerlink" title="åˆ›å»ºå®ä½“ç±»"></a>åˆ›å»ºå®ä½“ç±»</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Family</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Indexed</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> type<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Indexed</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">Family</span><span class="token punctuation">(</span><span class="token class-name">String</span> type<span class="token punctuation">,</span><span class="token class-name">String</span> username<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>type <span class="token operator">=</span> type<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>username <span class="token operator">=</span> username<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Address</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Indexed</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> city<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Indexed</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> country<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">Address</span><span class="token punctuation">(</span><span class="token class-name">String</span> city<span class="token punctuation">,</span><span class="token class-name">String</span> country<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>city <span class="token operator">=</span> city<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>country <span class="token operator">=</span> country<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@RedisHash</span><span class="token punctuation">(</span><span class="token string">"persons"</span><span class="token punctuation">)</span><span class="token comment">//æŒ‡å®šæ“ä½œå®ä½“ç±»å¯¹è±¡å†Redisæ•°æ®åº“ä¸­çš„å­˜å‚¨ç©ºé—´ã€‚</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Id</span><span class="token comment">//æ ‡è¯†å®ä½“ç±»ä¸»é”®</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Indexed</span><span class="token comment">//æ ‡è¯†å¯¹åº”å±æ€§å†Redisæ•°æ®åº“ä¸­ç”Ÿæˆçš„è€³æœºç´¢å¼•ã€‚</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> firstname<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Indexed</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> lastname<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Address</span> address<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Family</span><span class="token punctuation">></span></span> familyList<span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token class-name">String</span> firstname<span class="token punctuation">,</span><span class="token class-name">String</span> lastname<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>firstname <span class="token operator">=</span> firstname<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lastname <span class="token operator">=</span> lastname<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="æµ‹è¯•-1"><a href="#æµ‹è¯•-1" class="headerlink" title="æµ‹è¯•"></a>æµ‹è¯•</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RunWith</span><span class="token punctuation">(</span><span class="token class-name">SpringRunner</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@SpringBootTest</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApplicationTests</span><span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">PersonRepository</span> <span class="token class-name">RedisRepository</span><span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">savePerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">Person</span> person <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">,</span><span class="token string">"æœ‰æ‰"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Person</span> person1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token string">"james"</span><span class="token punctuation">,</span><span class="token string">"Harden"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Address</span> address <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Address</span><span class="token punctuation">(</span><span class="token string">"åŒ—äº¬"</span><span class="token punctuation">,</span><span class="token string">"China"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        person<span class="token punctuation">.</span><span class="token function">setAddress</span><span class="token punctuation">(</span>address<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Family</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Family</span><span class="token punctuation">(</span><span class="token string">"çˆ¶äº²"</span><span class="token punctuation">,</span><span class="token string">"å¼ è‰¯"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Family</span><span class="token punctuation">(</span><span class="token string">"æ¯äº²"</span><span class="token punctuation">,</span><span class="token string">"æé¦™å›"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        person<span class="token punctuation">.</span><span class="token function">setFamilyList</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">Person</span> save <span class="token operator">=</span> <span class="token class-name">RedisRepository</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Person</span> save2 <span class="token operator">=</span> <span class="token class-name">RedisRepository</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>person1<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>save<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>save2<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">selectPerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Person</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token class-name">RedisRepository</span><span class="token punctuation">.</span><span class="token function">findByAddress_City</span><span class="token punctuation">(</span><span class="token string">"åŒ—äº¬"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updatePerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">Person</span> person <span class="token operator">=</span> <span class="token class-name">RedisRepository</span><span class="token punctuation">.</span><span class="token function">findByFirstnameAndLastname</span><span class="token punctuation">(</span><span class="token string">"å¼ ä¸‰"</span><span class="token punctuation">,</span><span class="token string">"æœ‰æ‰"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        person<span class="token punctuation">.</span><span class="token function">setFirstname</span><span class="token punctuation">(</span><span class="token string">"å°æ˜"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Person</span> update <span class="token operator">=</span> <span class="token class-name">RedisRepository</span><span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>update<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deletePerson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">Person</span> person <span class="token operator">=</span> <span class="token class-name">RedisRepository</span><span class="token punctuation">.</span><span class="token function">findByFirstnameAndLastname</span><span class="token punctuation">(</span><span class="token string">"å°æ˜"</span><span class="token punctuation">,</span><span class="token string">"æœ‰æ‰"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RedisRepository</span><span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">RedisRepository</span><span class="token punctuation">.</span><span class="token function">findAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å†Redis Serviceå¼€å¯çš„æƒ…å†µä¸‹ï¼Œä¾æ¬¡è¿è¡Œæµ‹è¯•æ–¹æ³•å°±å¯ä»¥çœ‹åˆ°æ•ˆæœ</p>
<h2 id="Spring-boot-è§†å›¾æŠ€æœ¯"><a href="#Spring-boot-è§†å›¾æŠ€æœ¯" class="headerlink" title="Spring boot è§†å›¾æŠ€æœ¯"></a>Spring boot è§†å›¾æŠ€æœ¯</h2><h3 id="ThymeleafåŸºæœ¬è¯­æ³•"><a href="#ThymeleafåŸºæœ¬è¯­æ³•" class="headerlink" title="ThymeleafåŸºæœ¬è¯­æ³•"></a>ThymeleafåŸºæœ¬è¯­æ³•</h3><p>Thymeleafä¾èµ–</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-thymeleaf<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!--xmlns:th=å¼•å…¥Thymeleafæ¨¡æ¿å¼•æ“--></span>
<span class="token comment">&lt;!--thæ ‡ç­¾æ˜¯Thymeleafæä¾›çš„æ¨¡æ¿æ ‡ç­¾--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>th</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.thymeleaf.org<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Thymeleafå¸¸ç”¨æ ‡ç­¾</p>
<table>
<thead>
<tr>
<th><strong>th:insert</strong></th>
<th><strong>é¡µé¢ç‰‡æ®µåŒ…å«ï¼ˆç±»ä¼¼</strong>JSPä¸­çš„includeæ ‡ç­¾ï¼‰</th>
</tr>
</thead>
<tbody><tr>
<td>th:replace</td>
<td>é¡µé¢ç‰‡æ®µåŒ…å«ï¼ˆç±»ä¼¼JSPä¸­çš„includeæ ‡ç­¾ï¼‰</td>
</tr>
<tr>
<td>th:each</td>
<td>å…ƒç´ éå†ï¼ˆç±»ä¼¼JSPä¸­çš„c:forEachæ ‡ç­¾ï¼‰</td>
</tr>
<tr>
<td>th:if</td>
<td>æ¡ä»¶åˆ¤æ–­ï¼Œå¦‚æœä¸ºçœŸ</td>
</tr>
<tr>
<td>th:unless</td>
<td>æ¡ä»¶åˆ¤æ–­ï¼Œå¦‚æœä¸ºå‡</td>
</tr>
<tr>
<td>th:switch</td>
<td>æ¡ä»¶åˆ¤æ–­ï¼Œè¿›è¡Œé€‰æ‹©æ€§åŒ¹é…</td>
</tr>
<tr>
<td>th:case</td>
<td>æ¡ä»¶åˆ¤æ–­ï¼Œè¿›è¡Œé€‰æ‹©æ€§åŒ¹é…</td>
</tr>
<tr>
<td>th:object</td>
<td>å˜é‡å£°æ˜</td>
</tr>
<tr>
<td>th:with</td>
<td>å˜é‡å£°æ˜</td>
</tr>
<tr>
<td>th:attr</td>
<td>é€šç”¨å±æ€§ä¿®æ”¹</td>
</tr>
<tr>
<td>th:attrprepend</td>
<td>é€šç”¨å±æ€§ä¿®æ”¹ï¼Œå°†è®¡ç®—ç»“æœè¿½åŠ å‰ç¼€åˆ°ç°æœ‰å±æ€§å€¼</td>
</tr>
<tr>
<td>th:attrappend</td>
<td>é€šç”¨å±æ€§ä¿®æ”¹ï¼Œå°†è®¡ç®—ç»“æœè¿½åŠ åç¼€åˆ°ç°æœ‰å±æ€§å€¼</td>
</tr>
<tr>
<td>th:value</td>
<td>å±æ€§å€¼ä¿®æ”¹ï¼ŒæŒ‡å®šæ ‡ç­¾å±æ€§å€¼</td>
</tr>
<tr>
<td>th:href</td>
<td>ç”¨äºè®¾å®šé“¾æ¥åœ°å€</td>
</tr>
<tr>
<td>th:src</td>
<td>ç”¨äºè®¾å®šé“¾æ¥åœ°å€</td>
</tr>
<tr>
<td>th:text</td>
<td>ç”¨äºæŒ‡å®šæ ‡ç­¾æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹</td>
</tr>
<tr>
<td>th:utext</td>
<td>ç”¨äºæŒ‡å®šæ ‡ç­¾æ˜¾ç¤ºçš„æ–‡æœ¬å†…å®¹ï¼Œå¯¹ç‰¹æ®Šæ ‡ç­¾ä¸è½¬ä¹‰</td>
</tr>
<tr>
<td>th:fragment</td>
<td>å£°æ˜ç‰‡æ®µ</td>
</tr>
<tr>
<td>th:remove</td>
<td>ç§»é™¤ç‰‡æ®µ</td>
</tr>
</tbody></table>
<p>å¦‚ï¼š</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>mb-4<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">th:</span>src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@&#123;/img/img.jpg&#125;<span class="token punctuation">"</span></span> <span class="token attr-name">width</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>72<span class="token punctuation">"</span></span> <span class="token attr-name">height</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>72<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="æ ‡å‡†è¡¨è¾¾å¼"><a href="#æ ‡å‡†è¡¨è¾¾å¼" class="headerlink" title="æ ‡å‡†è¡¨è¾¾å¼"></a>æ ‡å‡†è¡¨è¾¾å¼</h4><table>
<thead>
<tr>
<th><strong>è¯´æ˜</strong></th>
<th><strong>è¡¨è¾¾å¼è¯­æ³•</strong></th>
</tr>
</thead>
<tbody><tr>
<td>å˜é‡è¡¨è¾¾å¼</td>
<td>${â€¦}</td>
</tr>
<tr>
<td>é€‰æ‹©å˜é‡è¡¨è¾¾å¼</td>
<td>*{â€¦}</td>
</tr>
<tr>
<td>æ¶ˆæ¯è¡¨è¾¾å¼</td>
<td>#{â€¦}</td>
</tr>
<tr>
<td>é“¾æ¥URLè¡¨è¾¾å¼</td>
<td>@{â€¦}</td>
</tr>
<tr>
<td>ç‰‡æ®µè¡¨è¾¾å¼</td>
<td>~{â€¦}</td>
</tr>
</tbody></table>
<p>Thymeleafä¸ºæ‰€åœ¨å˜é‡æ‰€åœ¨åŸŸæä¾›äº†ä¸€äº›å†…ç½®å¯¹è±¡</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td>#ctx</td>
<td>ä¸Šä¸‹æ–‡å¯¹è±¡</td>
</tr>
<tr>
<td>#vars</td>
<td>ä¸Šä¸‹æ–‡å˜é‡</td>
</tr>
<tr>
<td>#locale</td>
<td>ä¸Šä¸‹æ–‡åŒºåŸŸè®¾ç½®</td>
</tr>
<tr>
<td>#request</td>
<td>ï¼ˆä»…é™Web Contextï¼‰HttpServletRequestå¯¹è±¡</td>
</tr>
<tr>
<td>#response</td>
<td>ï¼ˆä»…é™Web Contextï¼‰HttpServletResponseå¯¹è±¡</td>
</tr>
<tr>
<td>#session</td>
<td>ï¼ˆä»…é™Web Contextï¼‰HttpSessionå¯¹è±¡</td>
</tr>
<tr>
<td>#servletContext</td>
<td>ï¼ˆä»…é™Web Contextï¼‰ServletContextå¯¹è±¡</td>
</tr>
</tbody></table>
<h4 id="é€‰æ‹©å˜é‡è¡¨è¾¾å¼"><a href="#é€‰æ‹©å˜é‡è¡¨è¾¾å¼" class="headerlink" title="é€‰æ‹©å˜é‡è¡¨è¾¾å¼"></a>é€‰æ‹©å˜é‡è¡¨è¾¾å¼</h4><p><a name="m1">ä¾‹å¦‚</a></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>th</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.thymeleaf.org<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">th:</span>object</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;session.user&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!--ä»sessionä¸­è·å–Userå¯¹è±¡,Userå¯¹è±¡åœ¨ä¹‹å‰å·²ç»æ·»åŠ åˆ°äº†sessionä¸­
    &lt;p>åœ°åŒº:&lt;span th:text="$&#123;#locale.country&#125;">&lt;/span>&lt;/p>&lt;!--è·å–å›½å®¶--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>firstName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;#object.firstName&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--è·å–userçš„firstName--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>lastName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;session.user.lastName&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--è·å–userçš„lastName--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>æ€§åˆ«<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>*&#123;sex&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--è·å–userçš„sex--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="è¿æ¥è¡¨è¾¾å¼"><a href="#è¿æ¥è¡¨è¾¾å¼" class="headerlink" title="è¿æ¥è¡¨è¾¾å¼"></a>è¿æ¥è¡¨è¾¾å¼</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://www.baidu.com<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@&#123;https://www.baidu.com&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="ç‰‡æ®µè¡¨è¾¾å¼"><a href="#ç‰‡æ®µè¡¨è¾¾å¼" class="headerlink" title="ç‰‡æ®µè¡¨è¾¾å¼"></a>ç‰‡æ®µè¡¨è¾¾å¼</h4><pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">th:</span>insert</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>~&#123;test::p&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--é€šè¿‡inseræ’å…¥classpath:/resources/templates/ä¸‹test.htmlç”¨pæ ‡ç­¾åŒ…å«çš„ç‰‡æ®µ--></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h3 id="ThymeleafåŸºæœ¬ä½¿ç”¨"><a href="#ThymeleafåŸºæœ¬ä½¿ç”¨" class="headerlink" title="ThymeleafåŸºæœ¬ä½¿ç”¨"></a>ThymeleafåŸºæœ¬ä½¿ç”¨</h3><h4 id="é™æ€é¡µé¢çš„è®¿é—®"><a href="#é™æ€é¡µé¢çš„è®¿é—®" class="headerlink" title="é™æ€é¡µé¢çš„è®¿é—®"></a>é™æ€é¡µé¢çš„è®¿é—®</h4><p><code>classpath</code>æ˜¯springbooté¡¹ç›®çš„resourcesç›®å½•ã€‚ç”Ÿæˆtargetæ—¶å°±æ˜¯targetä¸‹çš„classes</p>
<p><code>classpath:/META-INF/resources/</code> <code>classpath:/resources/</code> <code>closspath:/static/</code> <code>classpath:/public/</code>ä¸‹éƒ½å¯ä»¥å­˜æ”¾é™æ€èµ„æºï¼Œå¯¹äºè¿™äº›æ–‡ä»¶å¤¹ä¸‹çš„é™æ€èµ„æºå¯ä»¥ç›´æ¥é€šè¿‡<code>åŸŸå:ç«¯å£/</code>+<code>è·¯å¾„</code>è®¿é—®</p>
<h4 id="ä½¿ç”¨Thymeleaf"><a href="#ä½¿ç”¨Thymeleaf" class="headerlink" title="ä½¿ç”¨Thymeleaf"></a>ä½¿ç”¨Thymeleaf</h4><p>é…ç½®æ¨¡æ¿å‚æ•°</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment"># æ˜¯å¦å¯ç”¨æ¨¡æ¿ç¼“å­˜,å¼€å‘æ˜¯false,è¿è¥æ˜¯true</span>
<span class="token attr-name">spring.thymeleaf.cache</span><span class="token punctuation">=</span><span class="token attr-value">false</span>
<span class="token comment">#æ¨¡æ¿ç¼–ç </span>
<span class="token attr-name">spring.thymeleaf.encoding</span><span class="token punctuation">=</span><span class="token attr-value">utf-8</span>
<span class="token comment">#åº”ç”¨äºæ¨¡æ¿çš„æ¨¡æ¿æ¨¡å¼</span>
<span class="token attr-name">spring.thymeleaf.mode</span><span class="token punctuation">=</span><span class="token attr-value">HTML5</span>
<span class="token comment">#æŒ‡å®šæ¨¡æ¿é¡µé¢å­˜æ”¾è·¯å¾„,é»˜è®¤æ˜¯åœ¨resources/templates/</span>
<span class="token attr-name">spring.thymeleaf.prefix</span><span class="token punctuation">=</span><span class="token attr-value">classpath:/templates/</span>
<span class="token comment">#æŒ‡å®šæ¨¡æ¿é¡µé¢åç§°åç¼€</span>
<span class="token attr-name">spring.thymeleaf.suffix</span><span class="token punctuation">=</span><span class="token attr-value">.html</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ›å»ºWebæ§åˆ¶ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Controller</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//@ResponseBody</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token class-name">HttpSession</span> session<span class="token punctuation">,</span> <span class="token class-name">Model</span> model<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//å°†Userå¯¹è±¡åŠ å…¥session,ç”¨äºæ¨¡æ¿é¡µé¢çš„ä½¿ç”¨</span>
        session<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"user"</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token string">"Parker"</span><span class="token punctuation">,</span><span class="token string">"Petter"</span><span class="token punctuation">,</span><span class="token string">"ç”·"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"index"</span><span class="token punctuation">;</span><span class="token comment">//è·³è½¬templatesä¸‹çš„index.html</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸€ä¸ªUserç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">String</span> firstName<span class="token punctuation">;</span>
    <span class="token class-name">String</span> lastName<span class="token punctuation">;</span>
    <span class="token class-name">String</span> sex<span class="token punctuation">;</span>
    <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token class-name">String</span> firstName<span class="token punctuation">,</span><span class="token class-name">String</span> lastName<span class="token punctuation">,</span><span class="token class-name">String</span> sex<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>firstName <span class="token operator">=</span> firstName<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>lastName <span class="token operator">=</span> lastName<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//çœç•¥getterå’Œsetter</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨resourcesç›®å½•ä¸‹çš„templatesä¸‹åˆ›å»ºæ¨¡æ¿é¡µé¢<code>index.html</code></p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>th</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.thymeleaf.org<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">th:</span>object</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;session.user&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token comment">&lt;!--ä»sessionä¸­è·å–Userå¯¹è±¡,Userå¯¹è±¡åœ¨ä¹‹å‰å·²ç»æ·»åŠ åˆ°äº†sessionä¸­
    &lt;p>åœ°åŒº:&lt;span th:text="$&#123;#locale.country&#125;">&lt;/span>&lt;/p>&lt;!--è·å–å›½å®¶--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>firstName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;#object.firstName&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--è·å–userçš„firstName--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>lastName<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;session.user.lastName&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--è·å–userçš„lastName--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>æ€§åˆ«<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>*&#123;sex&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span><span class="token comment">&lt;!--è·å–userçš„sex--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://www.baidu.com<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">th:</span>href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@&#123;https://www.baidu.com&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>è¿™é‡Œæ˜¯è¿æ¥<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name"><span class="token namespace">th:</span>insert</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>~&#123;test::p&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œé¡¹ç›®ï¼Œè®¿é—®indexå°±ä¼šæ˜¾ç¤ºæ¨¡æ¿é¡µé¢çš„å†…å®¹ã€‚</p>
<h4 id="ä½¿ç”¨Thymeleafé…ç½®å›½é™…åŒ–é¡µé¢"><a href="#ä½¿ç”¨Thymeleafé…ç½®å›½é™…åŒ–é¡µé¢" class="headerlink" title="ä½¿ç”¨Thymeleafé…ç½®å›½é™…åŒ–é¡µé¢"></a>ä½¿ç”¨Thymeleafé…ç½®å›½é™…åŒ–é¡µé¢</h4><p>ç•¥â€¦</p>
<h2 id="Spring-Boot-å®ç°Webçš„å¸¸ç”¨åŠŸèƒ½"><a href="#Spring-Boot-å®ç°Webçš„å¸¸ç”¨åŠŸèƒ½" class="headerlink" title="Spring Boot å®ç°Webçš„å¸¸ç”¨åŠŸèƒ½"></a>Spring Boot å®ç°Webçš„å¸¸ç”¨åŠŸèƒ½</h2><h3 id="Spring-MVCåŠŸèƒ½æ‰©å±•å®ç°"><a href="#Spring-MVCåŠŸèƒ½æ‰©å±•å®ç°" class="headerlink" title="Spring MVCåŠŸèƒ½æ‰©å±•å®ç°"></a>Spring MVCåŠŸèƒ½æ‰©å±•å®ç°</h3><h4 id="è·¯å¾„æ˜ å°„"><a href="#è·¯å¾„æ˜ å°„" class="headerlink" title="è·¯å¾„æ˜ å°„"></a>è·¯å¾„æ˜ å°„</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span><span class="token comment">//æ ‡æ³¨æ˜¯å¿…é¡»çš„</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MVCConfig</span> <span class="token keyword">implements</span> <span class="token class-name">WebMvcConfigurer</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">/**
     * æ˜ å°„è·¯å¾„åˆ°index.html ,è®¿é—®/indexå’Œã€index.htmlæ—¶
     *éƒ½ä¼šåˆ°äº‹å…ˆå‡†å¤‡å¥½çš„theamleafé¡µé¢ index.html
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addViewControllers</span><span class="token punctuation">(</span><span class="token class-name">ViewControllerRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        registry<span class="token punctuation">.</span><span class="token function">addViewController</span><span class="token punctuation">(</span><span class="token string">"/index"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registry<span class="token punctuation">.</span><span class="token function">addViewController</span><span class="token punctuation">(</span><span class="token string">"/index.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setViewName</span><span class="token punctuation">(</span><span class="token string">"index"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="è‡ªå®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨"><a href="#è‡ªå®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨" class="headerlink" title="è‡ªå®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨"></a>è‡ªå®šä¹‰ä¸€ä¸ªæ‹¦æˆªå™¨</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyFilter</span> <span class="token keyword">implements</span> <span class="token class-name">HandlerInterceptor</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">//æ‹¦æˆªè¯·æ±‚</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">preHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"filter it"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//è¿”å›å“åº”ä½¿è°ƒç”¨(åªæœ‰åœ¨preHandleè¿”å›trueæ—¶è°ƒç”¨)</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">postHandle</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">ModelAndView</span> modelAndView<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"response it"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//æœ¬æ¬¡è¯·æ±‚å“åº”ç»“æŸåè°ƒç”¨ï¼Œç”¨äºæ¸…ç†å ç”¨èµ„æºç­‰(åªæœ‰åœ¨preHandleè¿”å›trueæ—¶è°ƒç”¨)</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterCompletion</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">Object</span> handler<span class="token punctuation">,</span> <span class="token class-name">Exception</span> ex<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"free"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åœ¨ä¸Šé¢çš„<code>MVCConfig</code>é…ç½®ç±»æ·»åŠ é‡å†™æ–¹æ³•ã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addInterceptors</span><span class="token punctuation">(</span><span class="token class-name">InterceptorRegistry</span> registry<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        registry<span class="token punctuation">.</span><span class="token function">addInterceptor</span><span class="token punctuation">(</span>myFilter<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">addPathPatterns</span><span class="token punctuation">(</span><span class="token string">"/**"</span><span class="token punctuation">)</span><span class="token comment">//æ·»åŠ è¿‡æ»¤è·¯å¾„</span>
                <span class="token punctuation">.</span><span class="token function">excludePathPatterns</span><span class="token punctuation">(</span><span class="token string">"/NANA"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ’é™¤è·¯å¾„(æ”¾è¡Œ)</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä»¥ä¸Šé…ç½®è®©è®¿é—®é™¤äº†<code>/NANA</code>è·¯å¾„çš„æ‰€æœ‰è¯·æ±‚éƒ½ä¼šè§¦å‘è‡ªå®šä¹‰çš„è¿‡æ»¤å™¨ã€‚</p>
<h3 id="Spring-Boot-æ•´åˆServletä¸‰å¤§ç»„ä»¶"><a href="#Spring-Boot-æ•´åˆServletä¸‰å¤§ç»„ä»¶" class="headerlink" title="Spring Boot æ•´åˆServletä¸‰å¤§ç»„ä»¶"></a>Spring Boot æ•´åˆServletä¸‰å¤§ç»„ä»¶</h3><h4 id="ç»„ä»¶æ³¨å†Œæ•´åˆServletä¸‰ç»„ä»¶"><a href="#ç»„ä»¶æ³¨å†Œæ•´åˆServletä¸‰ç»„ä»¶" class="headerlink" title="ç»„ä»¶æ³¨å†Œæ•´åˆServletä¸‰ç»„ä»¶"></a>ç»„ä»¶æ³¨å†Œæ•´åˆServletä¸‰ç»„ä»¶</h4><h5 id="æ•´åˆServlet"><a href="#æ•´åˆServlet" class="headerlink" title="æ•´åˆServlet"></a>æ•´åˆServlet</h5><p>ç¼–å†™servletç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestServlet</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        req<span class="token punctuation">.</span><span class="token function">setCharacterEncoding</span><span class="token punctuation">(</span><span class="token string">"UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html; charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        resp<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"hello"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> req<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> resp<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ServletException</span><span class="token punctuation">,</span> <span class="token class-name">IOException</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span>resp<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–å†™é…ç½®ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletConfig</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ServletRegistrationBean</span> <span class="token function">getServlet</span><span class="token punctuation">(</span><span class="token class-name">TestServlet</span> servlet<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">ServletRegistrationBean</span> registrationBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletRegistrationBean</span><span class="token punctuation">(</span>servlet<span class="token punctuation">,</span><span class="token string">"/servletTest1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¾ç½®è·¯å¾„æ˜ å°„</span>
        registrationBean<span class="token punctuation">.</span><span class="token function">addUrlMappings</span><span class="token punctuation">(</span><span class="token string">"/servletTest11"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ·»åŠ è·¯å¾„æ˜ å°„</span>
        <span class="token keyword">return</span> registrationBean<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®¿é—®<code>/servletTest1</code>å’Œ<code>/servletTest11</code>éƒ½å°†ä¼šäº¤ç»™ç¼–å†™çš„è¿™ä¸ªServletç±»å¤„ç†</p>
<h5 id="ç»„åˆFilter"><a href="#ç»„åˆFilter" class="headerlink" title="ç»„åˆFilter"></a>ç»„åˆFilter</h5><p>ç¼–å†™Servletç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestFilter</span> <span class="token keyword">extends</span> <span class="token class-name">HttpFilter</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">,</span> <span class="token class-name">HttpServletResponse</span> response<span class="token punctuation">,</span> <span class="token class-name">FilterChain</span> chain<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ServletException</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ç”¨æˆ·è®¿é—®äº†"</span><span class="token operator">+</span>request<span class="token punctuation">.</span><span class="token function">getRequestURL</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span>response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–å†™é…ç½®ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FilterConfig</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">FilterRegistrationBean</span> <span class="token function">getFilter</span><span class="token punctuation">(</span><span class="token class-name">TestFilter</span> filter<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">FilterRegistrationBean</span> registrationBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilterRegistrationBean</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        registrationBean<span class="token punctuation">.</span><span class="token function">setUrlPatterns</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span><span class="token string">"/test"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        registrationBean<span class="token punctuation">.</span><span class="token function">addUrlPatterns</span><span class="token punctuation">(</span><span class="token string">"/tests"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> registrationBean<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®¿é—®<code>tests</code>å’Œ<code>test</code>å°±ä¼šè¢«è‡ªå®šä¹‰çš„filterè¿‡æ»¤</p>
<h5 id="ç»„åˆListener"><a href="#ç»„åˆListener" class="headerlink" title="ç»„åˆListener"></a>ç»„åˆListener</h5><p>ç¼–å†™Listennerç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TestListener</span> <span class="token keyword">implements</span> <span class="token class-name">ServletContextListener</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextInitialized</span><span class="token punctuation">(</span><span class="token class-name">ServletContextEvent</span> sce<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"åˆ›å»ºäº†å¯¹è±¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">contextDestroyed</span><span class="token punctuation">(</span><span class="token class-name">ServletContextEvent</span> sce<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"é”€æ¯äº†å¯¹è±¡"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é…ç½®ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ListenerConfig</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">ServletListenerRegistrationBean</span> <span class="token function">getListener</span><span class="token punctuation">(</span><span class="token class-name">TestListener</span> listener<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">ServletListenerRegistrationBean</span> listenerRegistrationBean <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ServletListenerRegistrationBean</span><span class="token punctuation">(</span>listener<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> listenerRegistrationBean<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="ä½¿ç”¨è·¯å¾„æ‰«ææ•´åˆServletç»„ä»¶"><a href="#ä½¿ç”¨è·¯å¾„æ‰«ææ•´åˆServletç»„ä»¶" class="headerlink" title="ä½¿ç”¨è·¯å¾„æ‰«ææ•´åˆServletç»„ä»¶"></a>ä½¿ç”¨è·¯å¾„æ‰«ææ•´åˆServletç»„ä»¶</h4><p>å°†å‰é¢çš„<code>Servlet</code>ç±»<code>Filter</code>ç±»<code>Listener</code>ç±»çš„<code>Component</code>æ³¨è§£æ³¨é‡Šè°ƒ,ä½¿ç”¨<code>@WebServlet</code> <code>@WebFilter</code> <code>@WebListener</code>æ³¨è§£,ç„¶åå†ä¸»ç¨‹åºå¯åŠ¨ç±»è°ƒä»·<code>@ServletComponentScan</code>æ³¨è§£ã€‚</p>
<h3 id="æ–‡ä»¶çš„ä¸Šä¼ ä¸‹è½½"><a href="#æ–‡ä»¶çš„ä¸Šä¼ ä¸‹è½½" class="headerlink" title="æ–‡ä»¶çš„ä¸Šä¼ ä¸‹è½½"></a>æ–‡ä»¶çš„ä¸Šä¼ ä¸‹è½½</h3><h4 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h4><p>æ–‡ä»¶çš„ä¸Šä¼ å¯ä»¥ä½¿ç”¨Springbootæ•´åˆServletå®ç°ï¼Œä¸‹é¢æ˜¯ä½¿ç”¨Springbootçš„æ–¹æ³•ä¸Šä¼ æ–‡ä»¶ã€‚</p>
<p>ç¼–å†™å‰ç«¯thymeleafé¡µé¢</p>
<pre class="line-numbers language-html" data-language="html"><code class="language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>th</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.thymeleaf.org<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>æ–‡ä»¶ä¸Šä¼ <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/upload<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token comment">&lt;!--è¿™ä¸ªinputçš„nameå¾ˆé‡è¦,éœ€è¦ä¸åç«¯ç›¸åŒ--></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>files<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>æäº¤<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>
    <span class="token comment">&lt;!--é€šè¿‡åç«¯è®¾ç½®çš„å‚æ•°æ˜¾ç¤ºæ˜¯å¦ä¸Šä¼ æˆåŠŸ--></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name"><span class="token namespace">th:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;uploadStatus&#125;<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">th:</span>text</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>$&#123;uploadStatus&#125;<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¼–å†™æ§åˆ¶ç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Controller</span>
<span class="token comment">//æŒ‡å®šé…ç½®æ–‡ä»¶ä¸­çš„åç§°ã€‚</span>
<span class="token annotation punctuation">@ConfigurationProperties</span><span class="token punctuation">(</span>prefix <span class="token operator">=</span> <span class="token string">"upload"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">FileController</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">String</span> dirPath<span class="token punctuation">;</span>
	<span class="token comment">//æ–‡ä»¶ä¸Šä¼ çš„è·Ÿè·¯å¾„,å†é…ç½®æ–‡ä»¶ä¸­é…ç½®</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getDirPath</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> dirPath<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setDirPath</span><span class="token punctuation">(</span><span class="token class-name">String</span> dirPath<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>dirPath <span class="token operator">=</span> dirPath<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
	<span class="token comment">//è¿”å›ä¸Šä¼ æ–‡ä»¶çš„å‰ç«¯ç•Œé¢</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/toupload"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toUploadPage</span><span class="token punctuation">(</span><span class="token class-name">Model</span> model<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">return</span> <span class="token string">"upload"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//å¤„ç†ä¸Šä¼ çš„æ–‡ä»¶,MultipartFile[] çš„å‚æ•°åä¸€å®šè¦ä¸å‰ç«¯çš„nameä¸€è‡´</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">"/upload"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getFile</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span><span class="token punctuation">[</span><span class="token punctuation">]</span> files<span class="token punctuation">,</span><span class="token class-name">Model</span> model<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>dirPath<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token string">"error"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//ä¸ºmodelåŠ å…¥è±¡å¾æ˜¯å¦ä¸Šä¼ æˆåŠŸçš„å‚æ•°ï¼Œä¾›thymeleafä½¿ç”¨</span>
        model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"uploadStatus"</span><span class="token punctuation">,</span><span class="token string">"ä¸Šä¼ æˆåŠŸ"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>files<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"uploadStatus"</span><span class="token punctuation">,</span><span class="token string">"ä¸Šä¼ å¤±è´¥,æ— æ³•æ”¶åˆ°æ–‡ä»¶"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token string">"upload"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token comment">//å¯ä»¥å¤„ç†æ‰¹é‡ä¸Šä¼ ï¼Œåœ¨æœ¬å®ä¾‹ä¸­åªå¤„ç†äº†ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ã€‚</span>
        <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token operator">:</span>files<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token class-name">String</span> name <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            name <span class="token operator">=</span> UUID<span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"_"</span><span class="token operator">+</span>name<span class="token punctuation">;</span>
            <span class="token class-name">File</span> filepath <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>dirPath<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span>filepath<span class="token punctuation">.</span><span class="token function">exists</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                filepath<span class="token punctuation">.</span><span class="token function">mkdirs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">try</span><span class="token punctuation">&#123;</span>
                file<span class="token punctuation">.</span><span class="token function">transferTo</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>dirPath<span class="token operator">+</span>name<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">/*
                //ä¸€ä¸‹æ–¹æ³•ä¹Ÿå¯ä»¥ä¿å­˜æ–‡ä»¶ï¼Œä½†æ˜¯å¤æ‚å†™
                FileOutputStream os = new FileOutputStream(dirPath+name);
                InputStream is = file.getInputStream();
                byte[] buffer = new byte[1024];
                int length = 0;
                while((length=is.read(buffer))!=-1)&#123;
                    os.write(buffer,0,length);
                &#125;
                os.close();
                is.close();//è®°å¾—å…³é—­æµ
                */</span>
            <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
                <span class="token comment">//å¼‚å¸¸åˆ™è¿”å›å¤±è´¥</span>
                model<span class="token punctuation">.</span><span class="token function">addAttribute</span><span class="token punctuation">(</span><span class="token string">"uploadStatus"</span><span class="token punctuation">,</span><span class="token string">"ä¸Šä¼ å¤±è´¥"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token string">"upload"</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token string">"upload"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å†é…ç½®æ–‡ä»¶ä¸­é…ç½®</p>
<pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#thymeleafé…ç½®</span>
<span class="token attr-name">spring.thymeleaf.cache</span><span class="token punctuation">=</span><span class="token attr-value">false</span>
<span class="token attr-name">spring.thymeleaf.mode</span><span class="token punctuation">=</span><span class="token attr-value">HTML</span>
<span class="token comment">#æ–‡ä»¶æœ€å¤§å¤§å°é™åˆ¶</span>
<span class="token attr-name">spring.servlet.multipart.max-file-size</span><span class="token punctuation">=</span><span class="token attr-value">3MB</span>
<span class="token comment">#è¯·æ±‚å¤§å°é™åˆ¶</span>
<span class="token attr-name">spring.servlet.multipart.max-request-size</span><span class="token punctuation">=</span><span class="token attr-value">10MB</span>
<span class="token comment">#é…ç½®è·¯å¾„,å¦‚æœä¸æƒ³é”™ï¼Œé…ç½®æˆæ–‡ä»¶å¤¹ï¼Œ/ç»“å°¾</span>
<span class="token attr-name">upload.dirPath</span><span class="token punctuation">=</span><span class="token attr-value">E:/Zfile/</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®¿é—®<code>toupload</code>è·³è½¬åˆ°<code>upload.html</code>ä¸Šä¼ æ–‡ä»¶å³å¯ã€‚ä¿å­˜åˆ°é…ç½®çš„æ–‡ä»¶å¤¹</p>
<p>å¦‚æœæ–‡ä»¶ä¸Šä¼ è¶…è¿‡é…ç½®çš„å¤§å°ï¼Œæˆ‘åœ¨ç½‘ç»œæ‰¾åˆ°ä¸€ä¸‹è§£å†³æ–¹æ¡ˆã€‚</p>
<p>å¯ä»¥é€šè¿‡æ•æ‰å…¨å±€å¼‚å¸¸æ˜¾ç¤ºå¼‚å¸¸ä¿¡æ¯</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Error</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">Exception</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">exceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å‡ºç°é”™è¯¯"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"æ•æ‰åˆ°å¼‚å¸¸>>"</span><span class="token operator">+</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://juejin.cn/post/6959520793063587848">Spring Booté¡¹ç›®ä¼˜é›…çš„å¤„ç†å…¨å±€å¼‚å¸¸</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41835496/article/details/97429517"> è§£å†³ SpringBoot æ–‡ä»¶ä¸Šä¼  MultipartException å¼‚å¸¸é—®é¢˜</a></p>
<h4 id="æ–‡ä»¶ä¸‹è½½"><a href="#æ–‡ä»¶ä¸‹è½½" class="headerlink" title="æ–‡ä»¶ä¸‹è½½"></a>æ–‡ä»¶ä¸‹è½½</h4><p>è‹±æ–‡åç§°çš„ä¸‹è½½</p>
<p>æ²¡é”™ï¼Œä¸­è‹±æ–‡æ–‡ä»¶ä¸‹è½½æ˜¯æœ‰å·®å¼‚çš„ã€‚</p>
<p>å†ä¸Šé¢æ–‡ä»¶ä¸Šä¼ æ§åˆ¶ç±»ä¸­æ·»åŠ </p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/download"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">ResponseEntity</span><span class="token operator">&lt;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span> <span class="token function">download</span><span class="token punctuation">(</span><span class="token class-name">String</span> filename<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token comment">//File.separatoræ˜¯æ–‡ä»¶è·¯å¾„çš„åˆ†éš”ç¬¦,ä¸åŒæ“ä½œç³»ç»Ÿä¸åŒçš„åˆ†éš”ç¬¦ã€‚</span>
    <span class="token comment">//dirPathæ˜¯åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­é…ç½®æ–‡ä»¶ä¸­é…ç½®çš„</span>
    <span class="token class-name">File</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span>dirPath<span class="token operator">+</span><span class="token class-name">File</span><span class="token punctuation">.</span>separator<span class="token operator">+</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">HttpHeaders</span> headers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HttpHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è®¾ç½®å†…å®¹å¤„ç†æ ¼å¼</span>
    headers<span class="token punctuation">.</span><span class="token function">setContentDispositionFormData</span><span class="token punctuation">(</span><span class="token string">"attachment"</span><span class="token punctuation">,</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//è®¾ç½®å†…å®¹ç±»å‹</span>
    headers<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token class-name">MediaType</span><span class="token punctuation">.</span>APPLICATION_OCTET_STREAM<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//è¿”å›æ–‡ä»¶</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token class-name">FileUtils</span><span class="token punctuation">.</span><span class="token function">readFileToByteArray</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">,</span>headers<span class="token punctuation">,</span> <span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>OK<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å‡ºç°å¼‚å¸¸,å¦‚æ‰¾ä¸åˆ°æ–‡ä»¶,è¿”å›é”™è¯¯ä¿¡æ¯.</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">ResponseEntity</span><span class="token operator">&lt;</span><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span>UTF_8<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">HttpStatus</span><span class="token punctuation">.</span>EXPECTATION_FAILED<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®¿é—®<code>/download?filname=æ–‡ä»¶å</code>åˆ™å¯ä»¥ä¸‹è½½dirPathä¸‹çš„ç›¸å…³æ–‡ä»¶ã€‚</p>
<p>å¦‚æœæ–‡ä»¶åæ˜¯ä¸­æ–‡,ä¸‹è½½çš„æ–‡ä»¶åä¼šå‡ºç°ä¹±ç ï¼Œå…¨éƒ¨ä¸º<code>____</code></p>
<p>è§£å†³æ–¹æ¡ˆ,é’ˆå¯¹ä¸åŒçš„æµè§ˆå™¨è¿›è¡Œä¸åŒçš„æ–‡ä»¶åç¼–ç ã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">try</span><span class="token punctuation">&#123;</span>
    <span class="token class-name">String</span> name <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>filename<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span> <span class="token string">"utf-8"</span> <span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token string">"ISO8859-1"</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>
    filename <span class="token operator">=</span> name<span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token punctuation">&#125;</span>
headers<span class="token punctuation">.</span><span class="token function">setContentDispositionFormData</span><span class="token punctuation">(</span><span class="token string">"attachment"</span><span class="token punctuation">,</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>





<h2 id="SpringBootç¼“å­˜ç®¡ç†"><a href="#SpringBootç¼“å­˜ç®¡ç†" class="headerlink" title="SpringBootç¼“å­˜ç®¡ç†"></a>SpringBootç¼“å­˜ç®¡ç†</h2><h3 id="ä½“éªŒé»˜è®¤ç¼“å­˜"><a href="#ä½“éªŒé»˜è®¤ç¼“å­˜" class="headerlink" title="ä½“éªŒé»˜è®¤ç¼“å­˜"></a>ä½“éªŒé»˜è®¤ç¼“å­˜</h3><h4 id="åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®"><a href="#åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®" class="headerlink" title="åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®"></a>åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®</h4><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#å±•ç¤ºJPAè¿›è¡Œæ•°æ®åº“æŸ¥è¯¢çš„SQLè¯­å¥</span>
<span class="token attr-name">spring.jpa.show-sql</span><span class="token punctuation">=</span><span class="token attr-value">true</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h4 id="åˆ›å»ºServerç±»"><a href="#åˆ›å»ºServerç±»" class="headerlink" title="åˆ›å»ºServerç±»"></a>åˆ›å»ºServerç±»</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JpaService</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">DiscussRepository</span> repository<span class="token punctuation">;</span>
    <span class="token class-name">JpaService</span><span class="token punctuation">(</span><span class="token class-name">DiscussRepository</span> repository<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>repository <span class="token operator">=</span> repository<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    
    <span class="token keyword">public</span> <span class="token class-name">JpaTest</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">String</span> s<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> optional <span class="token operator">=</span> repository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JSONObject</span> object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>optional<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h4 id="åˆ›å»ºControllerç±»"><a href="#åˆ›å»ºControllerç±»" class="headerlink" title="åˆ›å»ºControllerç±»"></a>åˆ›å»ºControllerç±»</h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CacheTest</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">JpaService</span> service<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">CacheTest</span><span class="token punctuation">(</span><span class="token class-name">JpaService</span> service<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>service <span class="token operator">=</span> service<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/get"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">JpaTest</span> test <span class="token operator">=</span> service<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token string">"1234"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">JSONObject</span> object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JSONObject</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        object<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>test<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> object<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿è¡Œé¡¹ç›®,è®¿é—®&#x2F;get,åˆ·æ–°ä¸€æ¬¡é¡µé¢å°±ä¼šåœ¨æ§åˆ¶å°è¾“å‡ºä¸€æ¬¡SQLè¯­å¥ã€‚</p>
<h4 id="åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ "><a href="#åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ " class="headerlink" title="åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ "></a>åœ¨å¯åŠ¨ç±»ä¸Šæ·»åŠ </h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableCaching</span><span class="token comment">//å¼€å¯Springbootç¼“å­˜ç®¡ç†æ”¯æŒ</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h4 id="å†Serviceç±»çš„æŸ¥è¯¢æ–¹æ³•æ·»åŠ "><a href="#å†Serviceç±»çš„æŸ¥è¯¢æ–¹æ³•æ·»åŠ " class="headerlink" title="å†Serviceç±»çš„æŸ¥è¯¢æ–¹æ³•æ·»åŠ "></a>å†Serviceç±»çš„æŸ¥è¯¢æ–¹æ³•æ·»åŠ </h4><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token string">"jpatest"</span><span class="token punctuation">)</span><span class="token comment">//å°†æŸ¥è¯¢ç»“æœå­˜æ”¾å†SpringBootçš„é»˜è®¤ç¼“å­˜ä¸ºcommentçš„åç§°ç©ºé—´ã€‚</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>åœ¨æ²¡æœ‰æ·»åŠ å…¶ä»–å…¶ä»–çš„ç¼“å­˜ç»„ä»¶çš„æƒ…å†µä¸‹ï¼ŒSpringbootä¼šå¼€å¯é»˜è®¤ç¼“å­˜ç®¡ç†ç»„ä»¶,æ­¤æ—¶å†è®¿é—®ç›¸å…³é¡µé¢ï¼Œæ— è®ºåˆ·æ–°å¤šå°‘æ¬¡éƒ½åªä¼šæœ‰ä¸€æ¡sqlè¯­å¥è¢«æ‰“å°ï¼Œè¯´æ˜åªæŸ¥è¯¢äº†ä¾æ¬¡æ•°æ®åº“ï¼Œåé¢çš„æ•°æ®éƒ½æ¥è‡ªäºç¼“å­˜ã€‚</p>
<h3 id="SpringBootç¼“å­˜æ³¨è§£"><a href="#SpringBootç¼“å­˜æ³¨è§£" class="headerlink" title="SpringBootç¼“å­˜æ³¨è§£"></a>SpringBootç¼“å­˜æ³¨è§£</h3><p><font color="blue"><code>@EnableCaching</code></font> ç”±Springæ¡†æ¶æä¾›,é…ç½®å†ç±»ä¸Šå¼€å¯åŸºäºæ³¨è§£çš„ç¼“å­˜æ”¯æŒ</p>
<p><font color="blue"><code>@Cacheable</code></font>  æœ‰Springæ¡†æ¶æä¾›ï¼Œä½œç”¨äºç±»æˆ–æ–¹æ³•ï¼Œç”¨äºå¯¹æ–¹æ³•çš„æŸ¥è¯¢ç»“æœç¼“å­˜å‚¨å­˜ã€‚</p>
<h4 id="Cacheableæ³¨è§£"><a href="#Cacheableæ³¨è§£" class="headerlink" title="@Cacheableæ³¨è§£"></a>@Cacheableæ³¨è§£</h4><table>
<thead>
<tr>
<th><strong>å±æ€§å</strong></th>
<th><strong>è¯´æ˜</strong></th>
</tr>
</thead>
<tbody><tr>
<td>value&#x2F;cacheNames</td>
<td>æŒ‡å®šç¼“å­˜ç©ºé—´çš„åç§°ï¼Œå¿…é…å±æ€§ã€‚è¿™ä¸¤ä¸ªå±æ€§äºŒé€‰ä¸€ä½¿ç”¨</td>
</tr>
<tr>
<td>key</td>
<td>æŒ‡å®šç¼“å­˜æ•°æ®çš„keyï¼Œé»˜è®¤ä½¿ç”¨æ–¹æ³•å‚æ•°å€¼ï¼Œå¯ä»¥ä½¿ç”¨SpELè¡¨è¾¾å¼</td>
</tr>
<tr>
<td>keyGenerator</td>
<td>æŒ‡å®šç¼“å­˜æ•°æ®çš„keyçš„ç”Ÿæˆå™¨ï¼Œä¸keyå±æ€§äºŒé€‰ä¸€ä½¿ç”¨</td>
</tr>
<tr>
<td>cacheManager</td>
<td>æŒ‡å®šç¼“å­˜ç®¡ç†å™¨</td>
</tr>
<tr>
<td>cacheResolver</td>
<td>æŒ‡å®šç¼“å­˜è§£æå™¨ï¼Œä¸cacheManagerå±æ€§äºŒé€‰ä¸€ä½¿ç”¨</td>
</tr>
<tr>
<td>condition</td>
<td>æŒ‡å®šåœ¨ç¬¦åˆæŸæ¡ä»¶ä¸‹ï¼Œè¿›è¡Œæ•°æ®ç¼“å­˜</td>
</tr>
<tr>
<td>unless</td>
<td>æŒ‡å®šåœ¨ç¬¦åˆæŸæ¡ä»¶ä¸‹ï¼Œä¸è¿›è¡Œæ•°æ®ç¼“å­˜</td>
</tr>
<tr>
<td>sync</td>
<td>æŒ‡å®šæ˜¯å¦ä½¿ç”¨å¼‚æ­¥ç¼“å­˜ã€‚é»˜è®¤false</td>
</tr>
</tbody></table>
<p>value&#x2F;cacheNames  çš„ä½œç”¨ç›¸åŒå¯ä»¥åŒæ—¶æŒ‡å®šå¤šä¸ªåç§°ç©ºé—´ã€‚</p>
<p>key å±æ€§çš„ä½œç”¨æ˜¯æŒ‡å®šç¼“å­˜æ•°æ®å¯¹åº”çš„å”¯ä¸€æ ‡è¯†ï¼Œé»˜è®¤ä½¿ç”¨æ³¨è§£æ ‡è®°çš„æ–¹æ³•å‚æ•°å€¼ã€‚ç¼“å­˜çš„æœ¬è´¨æ˜¯Map,keyç”¨äºæŒ‡å®šå”¯ä¸€æ ‡è¯†,valueç”¨äºæŒ‡å®šç¼“å­˜æ•°æ®ã€‚</p>
<p>å¯ä»¥æ‰‹åŠ¨è®¾ç½®keyå±æ€§çš„å€¼,æˆ–è€…ä½¿ç”¨Springæ¡†æ¶æä¾›çš„SpELè¡¨è¾¾å¼</p>
<table>
<thead>
<tr>
<th>åç§°</th>
<th>ä½ç½®</th>
<th>æè¿°</th>
<th>ç¤ºä¾‹</th>
</tr>
</thead>
<tbody><tr>
<td>methodName</td>
<td>rootå¯¹è±¡</td>
<td>å½“å‰è¢«è°ƒç”¨çš„æ–¹æ³•å</td>
<td>#root.methodname</td>
</tr>
<tr>
<td>method</td>
<td>rootå¯¹è±¡</td>
<td>å½“å‰è¢«è°ƒç”¨çš„æ–¹æ³•</td>
<td>#root.method.name</td>
</tr>
<tr>
<td>target</td>
<td>rootå¯¹è±¡</td>
<td>å½“å‰è¢«è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡å®ä¾‹</td>
<td>#root.target</td>
</tr>
<tr>
<td>targetClass</td>
<td>rootå¯¹è±¡</td>
<td>å½“å‰è¢«è°ƒç”¨çš„ç›®æ ‡å¯¹è±¡çš„ç±»</td>
<td>#root.targetClass</td>
</tr>
<tr>
<td>args</td>
<td>rootå¯¹è±¡</td>
<td>å½“å‰è¢«è°ƒç”¨çš„æ–¹æ³•çš„å‚æ•°åˆ—è¡¨</td>
<td>#root.args[0]</td>
</tr>
<tr>
<td>caches</td>
<td>rootå¯¹è±¡</td>
<td>å½“å‰æ–¹æ³•è°ƒç”¨ä½¿ç”¨çš„ç¼“å­˜åˆ—è¡¨</td>
<td>#root.caches[0].name</td>
</tr>
<tr>
<td>Argument Name</td>
<td>æ‰§è¡Œä¸Šä¸‹æ–‡</td>
<td>å½“å‰è¢«è°ƒç”¨çš„æ–¹æ³•çš„å‚æ•°ï¼Œå¦‚findArtisan(Artisan artisan),å¯ä»¥é€šè¿‡#artsian.idè·å¾—å‚æ•°</td>
<td>#artsian.id</td>
</tr>
<tr>
<td>result</td>
<td>æ‰§è¡Œä¸Šä¸‹æ–‡</td>
<td>æ–¹æ³•æ‰§è¡Œåçš„è¿”å›å€¼ï¼ˆä»…å½“æ–¹æ³•æ‰§è¡Œåçš„åˆ¤æ–­æœ‰æ•ˆï¼Œå¦‚ unless cacheEvictçš„beforeInvocation&#x3D;falseï¼‰</td>
<td>#result</td>
</tr>
</tbody></table>
<p>@CachePutæ³¨è§£æ˜¯ç”±Springæ¡†æ¶æä¾›çš„ï¼Œå¯ä»¥ä½œç”¨äºç±»æˆ–æ–¹æ³•ï¼ˆé€šå¸¸ç”¨åœ¨æ•°æ®æ›´æ–°æ–¹æ³•ä¸Šï¼‰ï¼Œè¯¥æ³¨è§£çš„ä½œç”¨æ˜¯æ›´æ–°ç¼“å­˜æ•°æ®ã€‚@CachePutæ³¨è§£çš„æ‰§è¡Œé¡ºåºæ˜¯ï¼Œå…ˆè¿›è¡Œæ–¹æ³•è°ƒç”¨ï¼Œç„¶åå°†æ–¹æ³•ç»“æœæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚</p>
<p>@CachePutæ³¨è§£ä¹Ÿæä¾›äº†å¤šä¸ªå±æ€§ï¼Œè¿™äº›å±æ€§ä¸@Cacheableæ³¨è§£çš„å±æ€§å®Œå…¨ç›¸åŒã€‚</p>
<h4 id="CacheEvictæ³¨è§£"><a href="#CacheEvictæ³¨è§£" class="headerlink" title="@CacheEvictæ³¨è§£"></a>@CacheEvictæ³¨è§£</h4><p>@CacheEvictæ³¨è§£æ˜¯ç”±Springæ¡†æ¶æä¾›çš„ï¼Œå¯ä»¥ä½œç”¨äºç±»æˆ–æ–¹æ³•ï¼ˆé€šå¸¸ç”¨åœ¨æ•°æ®åˆ é™¤æ–¹æ³•ä¸Šï¼‰ï¼Œè¯¥æ³¨è§£çš„ä½œç”¨æ˜¯åˆ é™¤ç¼“å­˜æ•°æ®ã€‚@CacheEvictæ³¨è§£çš„é»˜è®¤æ‰§è¡Œé¡ºåºæ˜¯ï¼Œå…ˆè¿›è¡Œæ–¹æ³•è°ƒç”¨ï¼Œç„¶åå°†ç¼“å­˜è¿›è¡Œæ¸…é™¤ã€‚</p>
<p>@CacheEvictæ³¨è§£ä¹Ÿæä¾›äº†å¤šä¸ªå±æ€§ï¼Œè¿™äº›å±æ€§ä¸@Cacheableæ³¨è§£çš„å±æ€§åŸºæœ¬ç›¸åŒï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œè¿˜é¢å¤–æä¾›äº†ä¸¤ä¸ªç‰¹æ®Šå±æ€§allEntrieså’ŒbeforeInvocation</p>
<p>ï¼ˆ1ï¼‰allEntrieså±æ€§<br>   allEntrieså±æ€§è¡¨ç¤ºæ˜¯å¦æ¸…é™¤æŒ‡å®šç¼“å­˜ç©ºé—´ä¸­çš„æ‰€æœ‰ç¼“å­˜æ•°æ®ï¼Œé»˜è®¤å€¼ä¸ºfalseï¼ˆå³é»˜è®¤åªåˆ é™¤æŒ‡å®škeyå¯¹åº”çš„ç¼“å­˜æ•°æ®ï¼‰ã€‚<br>ï¼ˆ2ï¼‰beforeInvocationå±æ€§<br>   beforeInvocationå±æ€§è¡¨ç¤ºæ˜¯å¦åœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰è¿›è¡Œç¼“å­˜æ¸…é™¤ï¼Œé»˜è®¤å€¼ä¸ºfalseï¼ˆå³é»˜è®¤åœ¨æ‰§è¡Œæ–¹æ³•åå†è¿›è¡Œç¼“å­˜æ¸…é™¤ï¼‰ã€‚</p>
<h4 id="Cachingæ³¨è§£"><a href="#Cachingæ³¨è§£" class="headerlink" title="@Cachingæ³¨è§£"></a>@Cachingæ³¨è§£</h4><p>@Cachingæ³¨è§£ç”¨äºé’ˆå¯¹å¤æ‚è§„åˆ™çš„æ•°æ®ç¼“å­˜ç®¡ç†ï¼Œå¯ä»¥ä½œç”¨äºç±»æˆ–æ–¹æ³•ï¼Œåœ¨@Cachingæ³¨è§£å†…éƒ¨åŒ…å«æœ‰Cacheableã€putå’Œevictä¸‰ä¸ªå±æ€§ï¼Œåˆ†åˆ«å¯¹åº”äº@Cacheableã€@CachePutå’Œ@CacheEvictä¸‰ä¸ªæ³¨è§£ã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Caching</span><span class="token punctuation">(</span>cacheable<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span><span class="token string">"comment"</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">"#id"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
	put <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token string">"comment"</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">"#result.author"</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">Comment</span> <span class="token function">getComment</span><span class="token punctuation">(</span><span class="token keyword">int</span> comment_id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	<span class="token keyword">return</span> commentRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>comment_id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¯¹Commentå¯¹è±¡è¿›è¡Œç¼“å­˜,åˆ†åˆ«ä½¿ç”¨#idå’Œ#result.author.</p>
<h4 id="CacheConfigæ³¨è§£"><a href="#CacheConfigæ³¨è§£" class="headerlink" title="@CacheConfigæ³¨è§£"></a>@CacheConfigæ³¨è§£</h4><p>@CacheConfigæ³¨è§£ä½¿ç”¨åœ¨ç±»ä¸Šï¼Œä¸»è¦ç”¨äºç»Ÿç­¹ç®¡ç†ç±»ä¸­æ‰€æœ‰ä½¿ç”¨@Cacheableã€@CachePutå’Œ@CacheEvictæ³¨è§£æ ‡æ³¨æ–¹æ³•ä¸­çš„å…¬å…±å±æ€§ï¼Œè¿™äº›å…¬å…±å±æ€§åŒ…æ‹¬æœ‰cacheNamesã€keyGeneratorã€cacheManagerå’ŒcacheResolverã€‚</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@CacheConfig</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token string">"comment"</span><span class="token punctuation">)</span><span class="token comment">//åŒæ„æŒ‡å®šç¼“å­˜ç©ºé—´</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommentService</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">CommentRepository</span> commentRepository<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Cacheable</span><span class="token comment">//å¦‚æœå•ç‹¬è®¾ç½®cacheNamesä¼šé‡‡ç”¨å°±è¿‘è®¾ç½®çš„ç¼“å­˜ç©ºé—´ã€‚</span>
    <span class="token keyword">public</span> <span class="token class-name">Comment</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token keyword">int</span> comment_id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">Comment</span> comment <span class="token operator">=</span> commentRepository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>comment_id<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> comment<span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="SpringBoot-Redisç¼“å­˜"><a href="#SpringBoot-Redisç¼“å­˜" class="headerlink" title="SpringBoot Redisç¼“å­˜"></a>SpringBoot Redisç¼“å­˜</h3><p>SpringBoot æ”¯æŒçš„ç¼“å­˜ç»„ä»¶</p>
<p>ï¼ˆ1ï¼‰Generic<br>ï¼ˆ2ï¼‰JCache (JSR-107) (EhCache 3ã€Hazelcastã€Infinispanç­‰)<br>ï¼ˆ3ï¼‰EhCache 2.x<br>ï¼ˆ4ï¼‰Hazelcast<br>ï¼ˆ5ï¼‰Infinispan<br>ï¼ˆ6ï¼‰Couchbase<br>ï¼ˆ7ï¼‰Redis<br>ï¼ˆ8ï¼‰Caffeine<br>ï¼ˆ9ï¼‰Simpleï¼ˆé»˜è®¤ï¼‰</p>
<h4 id="åŸºäºæ³¨è§£Redisç¼“å­˜å®ç°"><a href="#åŸºäºæ³¨è§£Redisç¼“å­˜å®ç°" class="headerlink" title="åŸºäºæ³¨è§£Redisç¼“å­˜å®ç°"></a>åŸºäºæ³¨è§£Redisç¼“å­˜å®ç°</h4><h5 id="æ·»åŠ redisä¾èµ–-1"><a href="#æ·»åŠ redisä¾èµ–-1" class="headerlink" title="æ·»åŠ redisä¾èµ–"></a>æ·»åŠ redisä¾èµ–</h5><pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-data-redis<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="æ–‡ä»¶é…ç½®-1"><a href="#æ–‡ä»¶é…ç½®-1" class="headerlink" title="æ–‡ä»¶é…ç½®"></a>æ–‡ä»¶é…ç½®</h5><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token comment">#æœåŠ¡å™¨åœ°å€</span>
<span class="token attr-name">spring.redis.host</span><span class="token punctuation">=</span><span class="token attr-value">127.0.0.1</span>
<span class="token comment">#ç«¯å£</span>
<span class="token attr-name">spring.redis.port</span><span class="token punctuation">=</span><span class="token attr-value">6379</span>
<span class="token comment">#å¯†ç é»˜è®¤ç©º</span>
<span class="token attr-name">spring.redis.password</span><span class="token punctuation">=</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="ç¼–å†™Serviceç±»"><a href="#ç¼–å†™Serviceç±»" class="headerlink" title="ç¼–å†™Serviceç±»"></a>ç¼–å†™Serviceç±»</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommentService</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">DiscussRepository</span> repository<span class="token punctuation">;</span><span class="token comment">//jpaçš„repository</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">CommentService</span><span class="token punctuation">(</span><span class="token class-name">DiscussRepository</span> repository<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>repository <span class="token operator">=</span> repository<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token string">"comment"</span><span class="token punctuation">,</span>unless <span class="token operator">=</span> <span class="token string">"#result==null"</span><span class="token punctuation">)</span><span class="token comment">//ç»“æœä¸ºç©ºä¸ç¼“å­˜</span>
    <span class="token keyword">public</span> <span class="token class-name">JpaTest</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">Optional</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> optional <span class="token operator">=</span> repository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>optional<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">return</span> optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//æ›´æ–°ç¼“å­˜ï¼Œç”±äº@Cacheableæ ‡æ³¨ä¼šé»˜è®¤ä½¿ç”¨ä¸»é”®ä½œä¸ºkeyï¼Œæ‰€ä»¥å†æ›´æ–°ç¼“å­˜æ—¶ä½¿ç”¨ç›¸åŒçš„key</span>
    <span class="token annotation punctuation">@CachePut</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token string">"comment"</span><span class="token punctuation">,</span>key<span class="token operator">=</span><span class="token string">"#result.id"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">JpaTest</span> <span class="token function">updataTest</span><span class="token punctuation">(</span><span class="token class-name">JpaTest</span> test<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        repository<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>test<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> test<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//åˆ é™¤ç¼“å­˜</span>
    <span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span>cacheNames <span class="token operator">=</span> <span class="token string">"comment"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">deleteTest</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        repository<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="ç¼–å†™Controllerç±»"><a href="#ç¼–å†™Controllerç±»" class="headerlink" title="ç¼–å†™Controllerç±»"></a>ç¼–å†™Controllerç±»</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"> <span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">T</span><span class="token punctuation">&#123;</span>
	<span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">CommentService</span> service1<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/get2"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get2</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">JpaTest</span> jpaTest <span class="token operator">=</span> service1<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token string">"1234"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> jpaTest<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><font color='red'>æ‰“å¼€RedisæœåŠ¡ã€‚</font></p>
<p>å¦‚æœç›´æ¥å¯åŠ¨é¡¹ç›®ä¼šæŠ±é”™<code>DefaultSerializer requires a Serializable payload but received an object of type</code>ï¼Œæ˜¯ç”±äºæ²¡æœ‰å°†å¯¹è±¡åºåˆ—åŒ–çš„ç¼˜æ•…,ç®€å•æ¥è¯´å°±æ˜¯æ²¡æœ‰å°†å¯¹è±¡å¦‚ä½•è½¬å­˜åˆ°æ•°æ®åº“ä¸­è¿›è¡Œæ•°æ®å¤„ç†.</p>
<h5 id="ä¿®æ”¹å®ä½“ç±»"><a href="#ä¿®æ”¹å®ä½“ç±»" class="headerlink" title="ä¿®æ”¹å®ä½“ç±»"></a>ä¿®æ”¹å®ä½“ç±»</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@Entity</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JpaTest</span> <span class="token keyword">implements</span> <span class="token class-name">Serializable</span> <span class="token punctuation">&#123;</span><span class="token comment">//å®ç°JDKè‡ªå¸¦çš„åºåˆ—åŒ–æ¥å£</span>
    <span class="token annotation punctuation">@Id</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"mes"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"date"</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> date<span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤æ—¶é‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®ç›¸å…³è¿æ¥ï¼Œåˆ·æ–°å¤šæ¬¡ï¼Œä¹Ÿåªä¼šæ‰§è¡Œä¾æ¬¡JPAæ•°æ®åº“æŸ¥è¯¢,åé¢çš„æ•°æ®éƒ½æ¥è‡ªäºRediç¼“å­˜ã€‚</p>
<h3 id="åŸºäºAPIç¼“å­˜æœºåˆ¶"><a href="#åŸºäºAPIç¼“å­˜æœºåˆ¶" class="headerlink" title="åŸºäºAPIç¼“å­˜æœºåˆ¶"></a>åŸºäºAPIç¼“å­˜æœºåˆ¶</h3><h5 id="åˆ›å»ºServiceç±»"><a href="#åˆ›å»ºServiceç±»" class="headerlink" title="åˆ›å»ºServiceç±»"></a>åˆ›å»ºServiceç±»</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ApiService</span> <span class="token punctuation">&#123;</span>
    <span class="token class-name">RedisTemplate</span> redisTemplate<span class="token punctuation">;</span>
    <span class="token class-name">DiscussRepository</span> repository<span class="token punctuation">;</span><span class="token comment">//jpa repository</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">ApiService</span><span class="token punctuation">(</span><span class="token class-name">RedisTemplate</span> redisTemplate<span class="token punctuation">,</span><span class="token class-name">DiscussRepository</span> repository<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>redisTemplate <span class="token operator">=</span> redisTemplate<span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>repository <span class="token operator">=</span> repository<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token class-name">JpaTest</span> <span class="token function">findById</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token comment">//ä»ç¼“å­˜ä¸­æŸ¥è¯¢</span>
        <span class="token class-name">Object</span> object <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token operator">/</span>ç¼“å­˜ä¸­æœ‰å°±è¿”å›
        <span class="token keyword">if</span><span class="token punctuation">(</span>object<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">JpaTest</span><span class="token punctuation">)</span>object<span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token class-name">Optional</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JpaTest</span><span class="token punctuation">></span></span> optional <span class="token operator">=</span> repository<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>optional<span class="token punctuation">.</span><span class="token function">isPresent</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token comment">//å†™å…¥ç¼“å­˜ï¼Œ(keyï¼Œç¼“å­˜å­˜æ´»æ—¶é—´ï¼Œå•ä½)</span>
            redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span>optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span>DAYS<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> optional<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//åˆ é™¤ç¼“å­˜ã€‚</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        repository<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="Controllerç±»æ–¹æ³•"><a href="#Controllerç±»æ–¹æ³•" class="headerlink" title="Controllerç±»æ–¹æ³•"></a>Controllerç±»æ–¹æ³•</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Autowired</span>
    <span class="token class-name">ApiService</span> apiService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/get3"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">get3</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">JpaTest</span> jpaTest <span class="token operator">=</span> apiService<span class="token punctuation">.</span><span class="token function">findById</span><span class="token punctuation">(</span><span class="token string">"1234"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>jpaTest<span class="token operator">!=</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> jpaTest<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/delete"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">boolean</span> is <span class="token operator">=</span> apiService<span class="token punctuation">.</span><span class="token function">deleteById</span><span class="token punctuation">(</span><span class="token string">"1234"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>is<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token string">"ok"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span> <span class="token keyword">return</span> <span class="token string">"no"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="Spring-Security"><a href="#Spring-Security" class="headerlink" title="Spring Security"></a>Spring Security</h2><p>åœ¨é¡¹ç›®ä¸­æ·»åŠ spring-boot-startsecurityä¾èµ–</p>
<pre class="line-numbers language-xml" data-language="xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>spring-boot-starter-security<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ­¤æ—¶å¯åŠ¨å¯åŠ¨ç±»ï¼Œä¼šåœ¨æ§åˆ¶å°çª—å£ç”Ÿæˆpasswordï¼Œè®¿é—®ä»»ä½•é¡µé¢éƒ½éœ€è¦å…ˆç™»å½•æ‰å¯ä»¥è®¿é—®ï¼Œç™»å½•çš„é»˜è®¤ç”¨æˆ·åæ˜¯<code>user</code></p>
<p>MVC Securtyå®‰å…¨ç®¡ç†åŠŸèƒ½åœ¨å¼•å…¥ä¾èµ–åè‡ªåŠ¨ç”Ÿæ•ˆ,å…¶é»˜è®¤çš„å®‰å…¨é…ç½®æ˜¯<code>SecurityAutoConfiguration</code>å’Œ<code>UserDetailsServiceConfiguration</code>ä¸­å®ç°çš„ï¼Œå…¶ä¸­<code>SecurityAutoConfiguration</code>è‡ªåŠ¨åŒ–é…ç½®<code>SpringBootWebSecurityConfiguration</code>ç”¨äºå¯ç”¨Webå®‰å…¨ç®¡ç†ã€‚<code>UserDetailsServiceConfiguration</code>åˆ™ç”¨äºé…ç½®ç”¨æˆ·ä¿¡æ¯ã€‚</p>
<h3 id="ç”¨æˆ·è‡ªå®šä¹‰è®¤è¯"><a href="#ç”¨æˆ·è‡ªå®šä¹‰è®¤è¯" class="headerlink" title="ç”¨æˆ·è‡ªå®šä¹‰è®¤è¯"></a>ç”¨æˆ·è‡ªå®šä¹‰è®¤è¯</h3><p>é€šè¿‡è‡ªå®šä¹‰<code>WebSecurtyConfigurationAdapter</code>ç±»å‹çš„Beanç»„ä»¶å¯ä»¥å®Œå…¨å…³é—­Securityæä¾›çš„Webåº”ç”¨é»˜è®¤é…ç½®æˆ–è¦†ç›–é»˜è®¤è®¿é—®è§„åˆ™ï¼Œä½†æ˜¯ä¸ä¼šå…³é—­<code>UserDetailsService</code>ç”¨æˆ·ä¿¡æ¯è‡ªåŠ¨é…ç½®ç±».å¯ä»¥è‡ªå®šä¹‰<code>UserDetailsService</code>ã€<code>AuthenticationProvider</code>æˆ–<code>AuthenticationManage</code>ç±»å‹çš„Beanç»„ä»¶å…³é—­<code>UserDetailsService</code></p>
<p>WebSecurityConfigurationAdapterç±»çš„ä¸»è¦æ–¹æ³•ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody><tr>
<td>configure(AuthenticationManageBuilder auth)</td>
<td>å®šåˆ¶ç”¨æˆ·è®¤è¯ç®¡ç†å™¨æ¥å®ç°ç”¨æˆ·è®¤è¯</td>
</tr>
<tr>
<td>configure(HttpSecurity http)</td>
<td>å®šåˆ¶åŸºäºHttpè¯·æ±‚çš„ç”¨æˆ·è®¿é—®æ§åˆ¶</td>
</tr>
</tbody></table>
<p>SpringSecurityæä¾›å¤šç§è‡ªå®šä¹‰è®¤è¯æ–¹å¼ï¼šå†…å­˜èº«ä»½è®¤è¯ï¼ŒJDBCèº«ä»½è®¤è¯ï¼ŒLDAPèº«ä»½è®¤è¯ï¼Œèº«ä»½è®¤è¯æä¾›å•†ï¼Œèº«ä»½è¯¦æƒ…æœåŠ¡ã€‚</p>
<h4 id="å†…å­˜èº«ä»½è®¤è¯"><a href="#å†…å­˜èº«ä»½è®¤è¯" class="headerlink" title="å†…å­˜èº«ä»½è®¤è¯"></a>å†…å­˜èº«ä»½è®¤è¯</h4><h5 id="è‡ªå®šä¹‰WebSecurityConfigurerAdapteré…ç½®ç±»"><a href="#è‡ªå®šä¹‰WebSecurityConfigurerAdapteré…ç½®ç±»" class="headerlink" title="è‡ªå®šä¹‰WebSecurityConfigurerAdapteré…ç½®ç±»"></a>è‡ªå®šä¹‰WebSecurityConfigurerAdapteré…ç½®ç±»</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableWebSecurity</span><span class="token comment">//å¼€å¯MVC Securityæ”¯æŒ</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//è®¾ç½®å¯†ç çš„é»˜è®¤ç¼–ç å™¨</span>
        <span class="token class-name">BCryptPasswordEncoder</span> encoder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//ä½¿ç”¨å†…å­˜ç”¨æˆ·ä¿¡æ¯</span>
        auth<span class="token punctuation">.</span><span class="token function">inMemoryAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span>encoder<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withUser</span><span class="token punctuation">(</span><span class="token string">"shitou"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span>encoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">"common"</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">and</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">withUser</span><span class="token punctuation">(</span><span class="token string">"ddd"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">password</span><span class="token punctuation">(</span>encoder<span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span><span class="token string">"123456"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">roles</span><span class="token punctuation">(</span><span class="token string">"vip"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä»¥ä¸Šé…ç½®äº†ä¸¤ä¸ªç”¨æˆ·çš„ç”¨æˆ·åï¼Œå¯†ç å’Œè§’è‰²ã€‚</p>
<p>SpringSecurityæä¾›å¤šç§å¯†ç ç¼–è¾‘å™¨ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">BCryptPasswordEncoder</span>
<span class="token class-name">Pbkdf2PasswordEncoder</span>
<span class="token class-name">SCryptPasswordEncoder</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨roles(â€œcommonâ€)å’Œauthorities(â€œROLE_commonâ€)æ˜¯ç­‰æ•ˆçš„(å½“å‰ä»£ç çš„è§„åˆ™è¿˜æ²¡æœ‰ç”Ÿæ•ˆ)ã€‚</p>
<p>å†…å­˜è®¤è¯åªç”¨äºå¼€å‘ä¸­ã€‚</p>
<p>å†æ¬¡å¯åŠ¨é¡¹ç›®ï¼Œè®¿é—®ç›¸å…³é¡µé¢ï¼Œè¾“å…¥å¯†ç å°±å¯ä»¥ç™»å½•ã€‚</p>
<h4 id="JDBCè®¤è¯"><a href="#JDBCè®¤è¯" class="headerlink" title="JDBCè®¤è¯"></a>JDBCè®¤è¯</h4><h5 id="å¼•å…¥ä¾èµ–"><a href="#å¼•å…¥ä¾èµ–" class="headerlink" title="å¼•å…¥ä¾èµ–"></a>å¼•å…¥ä¾èµ–</h5><pre class="line-numbers language-54xml" data-language="54xml"><code class="language-54xml">&lt;!--æ•°æ®åº“è¿æ¥é©±åŠ¨--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;mysql&lt;&#x2F;groupId&gt;
    &lt;artifactId&gt;mysql-connector-java&lt;&#x2F;artifactId&gt;
&lt;&#x2F;dependency&gt;
&lt;!--æ•°æ®åº“è¿æ¥å¯åŠ¨å™¨--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;&#x2F;groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-jdbc&lt;&#x2F;artifactId&gt;
&lt;&#x2F;dependency&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h5><pre class="line-numbers language-properties" data-language="properties"><code class="language-properties"><span class="token attr-name">spring.datasource.url</span><span class="token punctuation">=</span><span class="token attr-value">jdbc:mysql://localhost:3306/test?serverTimezone=UTC</span>
<span class="token attr-name">spring.datasource.password</span><span class="token punctuation">=</span><span class="token attr-value">myproject</span>
<span class="token attr-name">spring.datasource.username</span><span class="token punctuation">=</span><span class="token attr-value">project</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<h5 id="ä¾æ¬¡åˆ›å»ºMySQLè¡¨"><a href="#ä¾æ¬¡åˆ›å»ºMySQLè¡¨" class="headerlink" title="ä¾æ¬¡åˆ›å»ºMySQLè¡¨"></a>ä¾æ¬¡åˆ›å»ºMySQLè¡¨</h5><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SET</span> NAMES utf8mb4<span class="token punctuation">;</span>
<span class="token keyword">SET</span> FOREIGN_KEY_CHECKS <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">-- ----------------------------</span>
<span class="token comment">-- Table structure for t_customer</span>
<span class="token comment">-- ----------------------------</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>t_customer<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>t_customer<span class="token punctuation">`</span>  <span class="token punctuation">(</span>
  <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>username<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>password<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>valid<span class="token punctuation">`</span> <span class="token keyword">tinyint</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">,</span> <span class="token punctuation">`</span>username<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  <span class="token keyword">INDEX</span> <span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8 <span class="token keyword">COLLATE</span> <span class="token operator">=</span> utf8_general_ci ROW_FORMAT <span class="token operator">=</span> Dynamic<span class="token punctuation">;</span>

<span class="token comment">-- ----------------------------</span>
<span class="token comment">-- Records of t_customer</span>
<span class="token comment">-- ----------------------------</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>t_customer<span class="token punctuation">`</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'zhangsan'</span><span class="token punctuation">,</span> <span class="token string">'$2a$10$Bg0S7sbxO5Fbobk1Rj2VsuT5nRrhrCu2roqY5ObsC432T/ugW8c7G'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>t_customer<span class="token punctuation">`</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'lisi'</span><span class="token punctuation">,</span> <span class="token string">'$2a$10$Bg0S7sbxO5Fbobk1Rj2VsuT5nRrhrCu2roqY5ObsC432T/ugW8c7G'</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SET</span> FOREIGN_KEY_CHECKS <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SET</span> NAMES utf8mb4<span class="token punctuation">;</span>
<span class="token keyword">SET</span> FOREIGN_KEY_CHECKS <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">-- ----------------------------</span>
<span class="token comment">-- Table structure for t_authority</span>
<span class="token comment">-- ----------------------------</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>t_authority<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>t_authority<span class="token punctuation">`</span>  <span class="token punctuation">(</span>
  <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>authority<span class="token punctuation">`</span> <span class="token keyword">varchar</span><span class="token punctuation">(</span><span class="token number">255</span><span class="token punctuation">)</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> utf8 <span class="token keyword">COLLATE</span> utf8_general_ci <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8 <span class="token keyword">COLLATE</span> <span class="token operator">=</span> utf8_general_ci ROW_FORMAT <span class="token operator">=</span> Dynamic<span class="token punctuation">;</span>

<span class="token comment">-- ----------------------------</span>
<span class="token comment">-- Records of t_authority</span>
<span class="token comment">-- ----------------------------</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>t_authority<span class="token punctuation">`</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'ROLE_common'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>t_authority<span class="token punctuation">`</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'ROLE_vip'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SET</span> FOREIGN_KEY_CHECKS <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">SET</span> NAMES utf8mb4<span class="token punctuation">;</span>
<span class="token keyword">SET</span> FOREIGN_KEY_CHECKS <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token comment">-- ----------------------------</span>
<span class="token comment">-- Table structure for t_customer_authority</span>
<span class="token comment">-- ----------------------------</span>
<span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token punctuation">`</span>t_customer_authority<span class="token punctuation">`</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token punctuation">`</span>t_customer_authority<span class="token punctuation">`</span>  <span class="token punctuation">(</span>
  <span class="token punctuation">`</span>id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">AUTO_INCREMENT</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>customer_id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token punctuation">`</span>authority_id<span class="token punctuation">`</span> <span class="token keyword">int</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span><span class="token punctuation">,</span>
  <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  <span class="token keyword">INDEX</span> <span class="token punctuation">`</span>t1<span class="token punctuation">`</span><span class="token punctuation">(</span><span class="token punctuation">`</span>customer_id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  <span class="token keyword">INDEX</span> <span class="token punctuation">`</span>t2<span class="token punctuation">`</span><span class="token punctuation">(</span><span class="token punctuation">`</span>authority_id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">USING</span> <span class="token keyword">BTREE</span><span class="token punctuation">,</span>
  <span class="token keyword">CONSTRAINT</span> <span class="token punctuation">`</span>t1<span class="token punctuation">`</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>customer_id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token punctuation">`</span>t_customer<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span><span class="token punctuation">,</span>
  <span class="token keyword">CONSTRAINT</span> <span class="token punctuation">`</span>t2<span class="token punctuation">`</span> <span class="token keyword">FOREIGN</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>authority_id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">REFERENCES</span> <span class="token punctuation">`</span>t_authority<span class="token punctuation">`</span> <span class="token punctuation">(</span><span class="token punctuation">`</span>id<span class="token punctuation">`</span><span class="token punctuation">)</span> <span class="token keyword">ON</span> <span class="token keyword">DELETE</span> <span class="token keyword">CASCADE</span> <span class="token keyword">ON</span> <span class="token keyword">UPDATE</span> <span class="token keyword">CASCADE</span>
<span class="token punctuation">)</span> <span class="token keyword">ENGINE</span> <span class="token operator">=</span> <span class="token keyword">InnoDB</span> <span class="token keyword">CHARACTER</span> <span class="token keyword">SET</span> <span class="token operator">=</span> utf8 <span class="token keyword">COLLATE</span> <span class="token operator">=</span> utf8_general_ci ROW_FORMAT <span class="token operator">=</span> Dynamic<span class="token punctuation">;</span>

<span class="token comment">-- ----------------------------</span>
<span class="token comment">-- Records of t_customer_authority</span>
<span class="token comment">-- ----------------------------</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>t_customer_authority<span class="token punctuation">`</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token punctuation">`</span>t_customer_authority<span class="token punctuation">`</span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">SET</span> FOREIGN_KEY_CHECKS <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h5 id="ç¼–å†™é…ç½®ç±»"><a href="#ç¼–å†™é…ç½®ç±»" class="headerlink" title="ç¼–å†™é…ç½®ç±»"></a>ç¼–å†™é…ç½®ç±»</h5><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>
	<span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">DataSource</span> dataSource<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">BCryptPasswordEncoder</span> encoder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//usernameå’Œpasswordçš„å­—æ®µåå¯ä»¥æ˜¯å…¶ä»–.</span>
        <span class="token class-name">String</span> userSql<span class="token operator">=</span><span class="token string">"select username,`password`,valid from t_customer "</span><span class="token operator">+</span><span class="token string">"where username=?"</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> authoritySql <span class="token operator">=</span> <span class="token string">"select username,t_authority.authority from "</span> <span class="token operator">+</span>
                <span class="token string">"t_customer,t_authority,t_customer_authority where "</span> <span class="token operator">+</span>
                <span class="token string">"t_customer_authority.authority_id=t_authority.id and "</span> <span class="token operator">+</span>
                <span class="token string">"t_customer_authority.customer_id=t_customer.id and "</span> <span class="token operator">+</span>
                <span class="token string">"t_customer.username=?"</span><span class="token punctuation">;</span>
        auth<span class="token punctuation">.</span><span class="token function">jdbcAuthentication</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span>encoder<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">dataSource</span><span class="token punctuation">(</span>dataSource<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">usersByUsernameQuery</span><span class="token punctuation">(</span>userSql<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">authoritiesByUsernameQuery</span><span class="token punctuation">(</span>authoritySql<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä»¥ä¸Šä»£ç Springbootä¼šæ ¹æ®å‰ç«¯è¾“å…¥çš„usernameå’ŒpasswordéªŒè¯èº«ä»½.</p>
<p>ç”±äºjdbcéªŒè¯æ¯æ¬¡éƒ½è¦æŸ¥è¯¢æ•°æ®åº“,ä¼šé™ä½ç½‘ç«™æ€§èƒ½ã€‚</p>
<h3 id="UserDetailsServiceèº«ä»½è®¤è¯"><a href="#UserDetailsServiceèº«ä»½è®¤è¯" class="headerlink" title="UserDetailsServiceèº«ä»½è®¤è¯"></a>UserDetailsServiceèº«ä»½è®¤è¯</h3><p>åˆ›å»ºä¸€ä¸ªServiceç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserDetailsServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">UserDetailsService</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token class-name">ReadUsers</span> readUsers<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetailsServiceImpl</span><span class="token punctuation">(</span><span class="token class-name">ReadUsers</span> readUsers<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>readUsers <span class="token operator">=</span> readUsers<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">UserDetails</span> <span class="token function">loadUserByUsername</span><span class="token punctuation">(</span><span class="token class-name">String</span> username<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">UsernameNotFoundException</span> <span class="token punctuation">&#123;</span>
        <span class="token comment">//User user = readUsers.getUserInfo(username);//è¿™é‡Œç”¨äºæŸ¥è¯¢ä¸€ä¸ªUserï¼Œæœ‰ç”¨æˆ·åå’Œå¯†ç æƒé™å³å¯</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token operator">==</span><span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">UsernameNotFoundException</span><span class="token punctuation">(</span><span class="token string">"no this user"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">SimpleGrantedAuthority</span><span class="token punctuation">></span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è·å–æƒé™æœ‰å‰ç¼€ROLE_</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SimpleGrantedAuthority</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getRole</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">UserDetails</span> userDetails <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>security<span class="token punctuation">.</span>core<span class="token punctuation">.</span>userdetails<span class="token punctuation">.</span></span>User</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getEmail</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>user<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> userDetails<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ·»åŠ ä¸€ä¸ª</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableWebSecurity</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SecurityConfig</span> <span class="token keyword">extends</span> <span class="token class-name">WebSecurityConfigurerAdapter</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">UserDetailsServiceImpl</span> userDetailsService<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">LoginFilter</span> loginFilter<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">public</span> <span class="token class-name">SecurityConfig</span><span class="token punctuation">(</span><span class="token class-name">UserDetailsServiceImpl</span> userDetailsService<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userDetailsService <span class="token operator">=</span> userDetailsService<span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">AuthenticationManagerBuilder</span> auth<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">BCryptPasswordEncoder</span> encoder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">BCryptPasswordEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        auth<span class="token punctuation">.</span><span class="token function">userDetailsService</span><span class="token punctuation">(</span>userDetailsService<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">passwordEncoder</span><span class="token punctuation">(</span>encoder<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è®¾ç½®å¯†ç ç¼–ç å™¨</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">HttpSecurity</span> http<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>
        http<span class="token punctuation">.</span><span class="token function">csrf</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">disable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">headers</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">frameOptions</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sameOrigin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        http<span class="token punctuation">.</span><span class="token function">authorizeRequests</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">//ä¸»é¡µæ”¾è¡Œ,æ³¨å†Œé¡µé¢æ”¾è¡Œ</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">//é™æ€èµ„æºæ”¾è¡Œ            </span>
           		 <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/js"</span><span class="token punctuation">,</span><span class="token string">"/js/**"</span><span class="token punctuation">,</span><span class="token string">"/css"</span><span class="token punctuation">,</span><span class="token string">"/css/**"</span><span class="token punctuation">,</span><span class="token string">"/jpg"</span><span class="token punctuation">,</span><span class="token string">"/jpg/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/user"</span><span class="token punctuation">,</span><span class="token string">"/user/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hasRole</span><span class="token punctuation">(</span><span class="token string">"0"</span><span class="token punctuation">)</span><span class="token comment">//ç”¨æˆ·é¡µé¢å¿…é¡»ç™»å½•ï¼Œæƒé™ä¸ºROLE_0;</span>
                <span class="token punctuation">.</span><span class="token function">antMatchers</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span><span class="token string">"/login/**"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">anyRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">authenticated</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        http<span class="token punctuation">.</span><span class="token function">formLogin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">loginPage</span><span class="token punctuation">(</span><span class="token string">"/login.html"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//ç™»å½•é¡µé¢</span>
                <span class="token punctuation">.</span><span class="token function">loginProcessingUrl</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">permitAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment">//æ¥å—ç™»å½•è¯·æ±‚çš„é“¾æ¥</span>
                <span class="token punctuation">.</span><span class="token function">defaultSuccessUrl</span><span class="token punctuation">(</span><span class="token string">"/user/home.html"</span><span class="token punctuation">)</span><span class="token comment">//æˆåŠŸåè·³è½¬</span>
                <span class="token punctuation">.</span><span class="token function">usernameParameter</span><span class="token punctuation">(</span><span class="token string">"email"</span><span class="token punctuation">)</span><span class="token comment">//é»˜è®¤ä¸ºusername,å¦‚æœå‰ç«¯nameæ˜¯emailåˆ™æ”¹ä¸ºemail</span>
                <span class="token punctuation">.</span><span class="token function">passwordParameter</span><span class="token punctuation">(</span><span class="token string">"password"</span><span class="token punctuation">)</span><span class="token comment">//é»˜è®¤password</span>
                <span class="token punctuation">.</span><span class="token function">failureUrl</span><span class="token punctuation">(</span><span class="token string">"/login.html?error=2"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        http<span class="token punctuation">.</span><span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">logoutUrl</span><span class="token punctuation">(</span><span class="token string">"/logout"</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">logoutSuccessUrl</span><span class="token punctuation">(</span><span class="token string">"/index.html"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//ç™»å‡ºé¡µé¢å’Œç™»å‡ºåè·³è½¬é¡µé¢ã€‚</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç®€å•å®ç°ç”¨æˆ·æ³¨å†Œè‡ªåŠ¨ç™»å½•ï¼š</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setOline</span><span class="token punctuation">(</span><span class="token class-name">String</span> email<span class="token punctuation">,</span><span class="token class-name">String</span> password<span class="token punctuation">,</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">UsernamePasswordAuthenticationToken</span> authenticationToken <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UsernamePasswordAuthenticationToken</span><span class="token punctuation">(</span>email<span class="token punctuation">,</span> password<span class="token punctuation">)</span><span class="token punctuation">;</span>
        authenticationToken<span class="token punctuation">.</span><span class="token function">setDetails</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">WebAuthenticationDetails</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Authentication</span> authentication <span class="token operator">=</span> authenticationToken<span class="token punctuation">;</span>
        <span class="token class-name">SecurityContextHolder</span><span class="token punctuation">.</span><span class="token function">getContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setAuthentication</span><span class="token punctuation">(</span>authentication<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h2 id="SpringBootä»»åŠ¡ç®¡ç†"><a href="#SpringBootä»»åŠ¡ç®¡ç†" class="headerlink" title="SpringBootä»»åŠ¡ç®¡ç†"></a>SpringBootä»»åŠ¡ç®¡ç†</h2><h3 id="å¼‚æ­¥ä»»åŠ¡"><a href="#å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="å¼‚æ­¥ä»»åŠ¡"></a>å¼‚æ­¥ä»»åŠ¡</h3><h4 id="æ²¡æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡"><a href="#æ²¡æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="æ²¡æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡"></a>æ²¡æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡</h4><p>åœ¨å¯åŠ¨ç±»æ·»åŠ @EnableAsyncæ³¨è§£å¯åŠ¨å¼‚æ­¥ä»»åŠ¡æ”¯æŒ</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@EnableAsync</span>
<span class="token annotation punctuation">@SpringBootApplication</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Demo2Application</span> <span class="token punctuation">&#123;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token class-name">SpringApplication</span><span class="token punctuation">.</span><span class="token function">run</span><span class="token punctuation">(</span><span class="token class-name">Demo2Application</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> args<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ›å»ºServiceç±»</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAsyncService</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Async</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendSMS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"å‘é€çŸ­ä¿¡éªŒè¯ç "</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Long</span> endTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"çŸ­ä¿¡ä¸šåŠ¡è¯è´¹æ—¶é—´"</span><span class="token operator">+</span><span class="token punctuation">(</span>endTime<span class="token operator">-</span>startTime<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"ms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>åˆ›å»ºä¸€ä¸ªControlleræµ‹è¯•</p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@RestController</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MyAsyncController</span> <span class="token punctuation">&#123;</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">MyAsyncService</span> myAsyncService<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/sendSMS"</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">sendSMS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">Long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            myAsyncService<span class="token punctuation">.</span><span class="token function">sendSMS</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token class-name">Long</span> endTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¸»è¿›ç¨‹èŠ±è´¹æ—¶é—´"</span><span class="token operator">+</span><span class="token punctuation">(</span>endTime<span class="token operator">-</span>startTime<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"ms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">"success"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®¿é—®<code>/sendSMS</code> å½“ä¸»è¿›ç¨‹å·²ç»å®Œæˆåä¸€ä¼šï¼ŒçŸ­ä¿¡ä¸šåŠ¡è¿›ç¨‹æ‰è¾“å‡ºç»“æœå·²å®Œæˆã€‚</p>
<h4 id="æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡"><a href="#æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡" class="headerlink" title="æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡"></a>æœ‰è¿”å›å€¼çš„å¼‚æ­¥ä»»åŠ¡</h4><p>å†åˆšæ‰çš„Serviceç±»ä¸­æ·»åŠ </p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@Async</span>
    <span class="token keyword">public</span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token function">processA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"A begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2222</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token class-name">Long</span> endTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"A End:"</span><span class="token operator">+</span><span class="token punctuation">(</span>endTime<span class="token operator">-</span>startTime<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"ms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AsyncResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">110</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token annotation punctuation">@Async</span>
    <span class="token keyword">public</span> <span class="token class-name">Future</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token function">processB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"B begin"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
            <span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">2222</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token class-name">Long</span> endTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"B end:"</span><span class="token operator">+</span><span class="token punctuation">(</span>endTime<span class="token operator">-</span>startTime<span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">"ms"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">AsyncResult</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token number">120</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>Controllerç±»ä¸­æ·»åŠ </p>
<pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">"/process"</span><span class="token punctuation">)</span>
   <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
       <span class="token class-name">Long</span> startTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token class-name">Future</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token class-name">A</span> <span class="token operator">=</span> myAsyncService<span class="token punctuation">.</span><span class="token function">processA</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token class-name">Future</span> <span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Integer</span><span class="token punctuation">></span></span> <span class="token class-name">B</span> <span class="token operator">=</span> myAsyncService<span class="token punctuation">.</span><span class="token function">processB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>
           <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"all return = "</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token class-name">A</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token class-name">B</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
           e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ExecutionException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
           e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token punctuation">&#125;</span>
       <span class="token class-name">Long</span> endTime <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"ä¸»è¿›ç¨‹èŠ±è´¹æ—¶é—´"</span><span class="token operator">+</span><span class="token punctuation">(</span>endTime<span class="token operator">-</span>startTime<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
       <span class="token keyword">return</span> <span class="token string">"success"</span><span class="token punctuation">;</span>

   <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è®¿é—®processç•Œé¢ï¼Œä¸»è¿›ç¨‹èŠ±è´¹çš„æ—¶é—´å¹¶ä¸æ˜¯ä¸¤ä¸ªå­è¿›ç¨‹çš„å’Œï¼Œè¯´æ˜ä¸¤ä¸ªå­è¿›ç¨‹æ˜¯å¼‚æ­¥æ‰§è¡Œï¼Œä¸”è¿”å›å€¼ä¹Ÿæ­£ç¡®ã€‚</p>
<p>å…³äº<a target="_blank" rel="noopener" href="https://blog.csdn.net/u014209205/article/details/80598209"> JAVA Futureç±»</a></p>
</div><ul class="post-copyright"><li class="post-copyright-author"><strong>æœ¬æ–‡ä½œè€…ï¼š</strong>è½èŠ±ç”Ÿ</li><li class="post-copyright-link"><strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://dbin.top/2022/03/02/%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF/Spring%20Boot%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="Spring Boot å­¦ä¹ ç¬”è®°">https://dbin.top/2022/03/02/%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF/Spring%20Boot%20%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a></li><li class="post-copyright-license"><strong>ç‰ˆæƒå£°æ˜ï¼š</strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é»˜è®¤é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank" rel="noopener" title="CC BY-NC-SA 4.0 "><svg class="icon"><use xlink:href="#icon-creative-commons-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-by-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-nc-line"></use></svg><svg class="icon"><use xlink:href="#icon-creative-commons-sa-line"></use></svg></a> è®¸å¯åè®®ã€‚</li></ul></section></article><div class="post-nav"><div class="post-nav-item"><a class="post-nav-prev" href="/2022/03/31/SpringBoot%E4%BD%BF%E7%94%A8HTTPS/" rel="prev" title="SpringBootä½¿ç”¨HTTPSå’ŒHTTP2.0"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-left-s-line"></use></svg><span class="post-nav-text">SpringBootä½¿ç”¨HTTPSå’ŒHTTP2.0</span></a></div><div class="post-nav-item"><a class="post-nav-next" href="/2022/02/24/%E5%BC%80%E5%8F%91/%E5%90%8E%E7%AB%AF/MongoDB%20Java%20Driver/" rel="next" title="MongoDB Java Driver"><span class="post-nav-text">MongoDB Java Driver</span><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-right-s-line"></use></svg></a></div></div></div></main><footer class="sidebar-translate" id="footer"><div class="copyright"><span>&copy; 2021 â€“ 2022 </span><a class="with-love" id="animate" target="_blank" rel="noopener" href="https://www.yunyoujun.cn/" title="ç½‘ç«™æºç æ¥è‡ª"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-cloud-line"></use></svg></a><span class="author"> è½èŠ±ç”Ÿ</span></div><div class="powered"><span>ç”± <a href="https://hexo.io" target="_blank" rel="noopener">Hexo</a> é©±åŠ¨ v6.0.0</span><span class="footer-separator">|</span><span>ä¸»é¢˜ - <a rel="noopener" href="https://github.com/YunYouJun/hexo-theme-yun" target="_blank"><span>Yun</span></a> v1.7.0</span></div><div class="live_time"><span>æœ¬åšå®¢å·²èŒèŒå“’åœ°è¿è¡Œ</span><span id="display_live_time"></span><span class="moe-text">(â—'â—¡'â—)</span><script>function blog_live_time() {
  setTimeout(blog_live_time, 1000);
  const start = new Date('2021-06-18T00:00:00');
  const now = new Date();
  const timeDiff = (now.getTime() - start.getTime());
  const msPerMinute = 60 * 1000;
  const msPerHour = 60 * msPerMinute;
  const msPerDay = 24 * msPerHour;
  const passDay = Math.floor(timeDiff / msPerDay);
  const passHour = Math.floor((timeDiff % msPerDay) / 60 / 60 / 1000);
  const passMinute = Math.floor((timeDiff % msPerHour) / 60 / 1000);
  const passSecond = Math.floor((timeDiff % msPerMinute) / 1000);
  display_live_time.innerHTML = " " + passDay + " å¤© " + passHour + " å°æ—¶ " + passMinute + " åˆ† " + passSecond + " ç§’";
}
blog_live_time();
</script></div></footer><a class="hty-icon-button" id="back-to-top" aria-label="back-to-top" href="#"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-arrow-up-s-line"></use></svg><svg class="progress-circle-container" viewBox="0 0 100 100"><circle class="progress-circle" id="progressCircle" cx="50" cy="50" r="48" fill="none" stroke="#4fcde3" stroke-width="2" stroke-linecap="round"></circle></svg></a><a class="popup-trigger hty-icon-button icon-search" id="search" href="javascript:;" title="æœç´¢"><span class="site-state-item-icon"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-search-line"></use></svg></span></a><script>window.addEventListener("DOMContentLoaded", () => {
  // Handle and trigger popup window
  document.querySelector(".popup-trigger").addEventListener("click", () => {
    document.querySelector(".popup").classList.add("show");
    setTimeout(() => {
      document.querySelector(".search-input").focus();
    }, 100);
  });

  // Monitor main search box
  const onPopupClose = () => {
    document.querySelector(".popup").classList.remove("show");
  };

  document.querySelector(".popup-btn-close").addEventListener("click", () => {
    onPopupClose();
  });

  window.addEventListener("keyup", event => {
    if (event.key === "Escape") {
      onPopupClose();
    }
  });
});
</script><script src="/js/search/local-search.js" defer></script><div class="popup search-popup"><div class="search-header"><span class="popup-btn-close close-icon hty-icon-button"><svg class="icon" aria-hidden="true"><use xlink:href="#icon-close-line"></use></svg></span></div><div class="search-input-container"><input class="search-input" id="local-search-input" type="text" placeholder="æœç´¢..." value=""></div><div id="local-search-result"></div></div><script>const date = new Date();
const today = (date.getMonth() + 1) + "-" + date.getDate()
const mourn_days = ["4-4","5-12","9-18"]
if (mourn_days.includes(today)) {
  document.documentElement.style.filter = "grayscale(1)";
}</script></div></body></html>